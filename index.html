<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SynTitan v2.5 - Data Collaboration Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #F7F7F8;
            color: #171719;
            line-height: 1.6;
        }

        .container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar - Hightouch Style */
        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar.collapsed .logo {
            display: none;
        }

        .sidebar.collapsed .nav-item span {
            display: none;
        }

        .sidebar.collapsed .nav-group-title {
            display: none;
        }

        .sidebar.collapsed .badge {
            display: none;
        }

        .sidebar.collapsed .nav-item {
            justify-content: center;
            padding: 12px;
        }

        .sidebar.collapsed .sidebar-header {
            padding: 16px 12px;
            justify-content: center;
        }

        .sidebar-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 69px;
        }

        .logo {
            font-size: 18px;
            font-weight: 800;
            color: #171719;
            font-family: 'Geist Mono', monospace;
        }

        .workspace-selector {
            background: #f3f4f6;
            color: #6b7280;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            margin-left: auto;
        }

        .nav-section {
            flex: 1;
            padding: 8px 0;
            overflow-y: auto;
        }

        .nav-group {
            margin-bottom: 24px;
        }

        .nav-group-title {
            font-size: 11px;
            font-weight: 600;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 8px 20px;
            margin-bottom: 4px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
            color: #6b7280;
            margin: 1px 12px;
            border-radius: 8px;
        }

        .nav-item:hover {
            background: #f3f4f6;
            color: #171719;
        }

        .nav-item.active {
            background: #1f2937;
            color: white;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
        }

        .nav-item .badge {
            background: #ef4444;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* Agent Analysis Animations */
        @keyframes initial-pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7);
                border-color: #667eea;
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 0 12px rgba(102, 126, 234, 0.4), 0 0 40px rgba(102, 126, 234, 0.3);
                border-color: #3b82f6;
                transform: scale(1.01);
            }
        }

        .team-dataset:hover {
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .team-dataset.active {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .module-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .module-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .module-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        /* Agent Analysis Styles */
        .panel-header {
            font-size: 16px;
            font-weight: 700;
            color: #171719;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .dataset-group-title {
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
        }

        .team-name {
            font-size: 14px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .dataset-description {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .dataset-fields {
            font-size: 11px;
            color: #9ca3af;
            background: #f9fafb;
            padding: 6px 8px;
            border-radius: 4px;
        }

        .analysis-title {
            font-size: 20px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 8px;
        }

        .analysis-description {
            font-size: 14px;
            color: #6b7280;
            background: rgba(102, 126, 234, 0.05);
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            letter-spacing: -0.02em;
        }

        .progress-title {
            font-size: 20px;
            font-weight: 600;
            color: #667eea;
        }

        .spar-panel {
            background: white;
            border-radius: 12px;
            padding: 24px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .collaboration-panel .panel-header {
            margin-bottom: 20px;
        }

        .sidebar.collapsed .nav-item span:not(.badge) {
            display: none;
        }

        .sidebar.collapsed .nav-group-title {
            display: none;
        }

        .sidebar.collapsed .workspace-selector {
            display: none;
        }

        /* Bottom Section */
        .sidebar-bottom {
            border-top: 1px solid #e5e7eb;
            padding: 12px 0;
        }

        .user-section {
            padding: 8px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 1px 12px;
            border-radius: 8px;
        }

        .user-section:hover {
            background: #f3f4f6;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-size: 14px;
            font-weight: 500;
            color: #171719;
        }

        .user-email {
            font-size: 12px;
            color: #6b7280;
        }

        .sidebar.collapsed .user-info {
            display: none;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: margin-left 0.3s ease;
        }

        .content-view {
            flex: 1;
            display: none;
            overflow-y: auto;
        }

        .content-view.active {
            display: flex !important;
            flex-direction: column;
        }

        /* Get Started View */
        .get-started-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .get-started-content {
            max-width: 800px;
            text-align: center;
        }

        .get-started-title {
            font-size: 32px;
            font-weight: 700;
            color: #171719;
            margin-bottom: 16px;
        }

        .get-started-subtitle {
            font-size: 18px;
            color: #6b7280;
            margin-bottom: 48px;
            line-height: 1.6;
        }

        .data-source-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            max-width: 600px;
            margin: 0 auto;
        }

        .data-source-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 32px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .data-source-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .data-source-card.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .data-source-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 20px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
        }

        .aws-icon {
            background: linear-gradient(135deg, #232f3e, #ff9900);
        }

        .demo-icon {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .data-source-title {
            font-size: 20px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 8px;
        }

        .data-source-desc {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.5;
        }

        .get-started-actions {
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 16px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: white;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }

        .btn-secondary:hover {
            background: #f3f4f6;
        }

        /* Header for other views */
        .content-header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 69px;
            box-sizing: border-box;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #171719;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-input {
            width: 300px;
            padding: 8px 16px 8px 40px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%236b7280"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg>') no-repeat 12px center;
            background-size: 16px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* Report Hub Styles */
        .hub-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .hub-sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }

        .filter-section {
            padding: 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .filter-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 16px;
        }

        .date-range {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 16px;
        }

        .date-input {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 13px;
        }

        .filters-list {
            flex: 1;
            padding: 0 24px 24px;
            overflow-y: auto;
        }

        .filter-group {
            margin-bottom: 24px;
        }

        .filter-group-title {
            font-size: 14px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .filter-count {
            background: #f3f4f6;
            color: #6b7280;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-item:hover {
            background: #f3f4f6;
            margin: 0 -8px;
            padding: 6px 8px;
            border-radius: 6px;
        }

        .filter-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #d1d5db;
            border-radius: 3px;
            position: relative;
            transition: all 0.2s ease;
        }

        .filter-checkbox.checked {
            background: #667eea;
            border-color: #667eea;
        }

        .filter-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: -2px;
            left: 2px;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .filter-label {
            font-size: 14px;
            color: #171719;
            flex: 1;
        }

        .filter-badge {
            background: #f3f4f6;
            color: #6b7280;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        /* Main Content Area */
        .hub-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-controls {
            background: white;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .view-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 6px;
            padding: 2px;
        }

        .view-btn {
            padding: 6px 12px;
            border: none;
            background: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
        }

        .view-btn.active {
            background: white;
            color: #171719;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .sort-select {
            padding: 6px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 13px;
            background: white;
        }

        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* Reports List */
        .reports-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .report-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .report-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .report-item.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .report-title {
            font-size: 16px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 6px;
        }

        .report-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #6b7280;
        }

        .meta-icon {
            font-size: 12px;
        }

        .report-conditions {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 12px;
        }

        .conditions-title {
            font-size: 11px;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .conditions-text {
            font-size: 11px;
            color: #4b5563;
            font-family: 'Geist Mono', monospace;
        }

        .report-tags {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .tag.team {
            background: #dbeafe;
            color: #1e40af;
        }

        .tag.module {
            background: #f3e8ff;
            color: #7c3aed;
        }

        .tag.version {
            background: #fef3c7;
            color: #d97706;
        }

        .tag.status {
            background: #d1fae5;
            color: #059669;
        }

        .report-actions {
            display: flex;
            gap: 6px;
        }

        .report-action {
            padding: 6px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #6b7280;
        }

        .report-action:hover {
            border-color: #667eea;
            color: #667eea;
        }

        /* Dataset Workspace Styles */
        .workspace-container {
            flex: 1;
            display: grid;
            grid-template-columns: 35% 65%;
            overflow: hidden;
        }

        .collaboration-panel {
            background: #f8f9fa;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }

        .active-users {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .users-title {
            font-size: 14px;
            font-weight: 600;
            color: #171719;
        }

        .user-avatars {
            display: flex;
            gap: 8px;
        }

        .user-avatar-small {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 600;
            position: relative;
        }

        .user-avatar-small.marketing { background: #667eea; }
        .user-avatar-small.finance { background: #10b981; }
        .user-avatar-small.sales { background: #f59e0b; }

        .user-avatar-small.online::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            border: 2px solid white;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            margin: 16px;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            height: calc(100vh - 32px);
        }

        .chat-header {
            background: #f8f9fa;
            padding: 16px 20px;
            border-bottom: 1px solid #e5e7eb;
            border-radius: 12px 12px 0 0;
        }

        .chat-title {
            font-size: 16px;
            font-weight: 600;
            color: #171719;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-messages {
            flex: 1;
            padding: 16px 20px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 16px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .message-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
            font-weight: 600;
        }

        .message-author {
            font-size: 13px;
            font-weight: 600;
            color: #171719;
        }

        .message-time {
            font-size: 11px;
            color: #6b7280;
        }

        .message-content {
            background: #f8f9fa;
            padding: 10px 14px;
            border-radius: 12px;
            margin-left: 32px;
            font-size: 14px;
            color: #374151;
            line-height: 1.4;
        }

        .message.ai .message-content {
            background: #e8f4fd;
            border-left: 3px solid #667eea;
        }

        .chat-input {
            display: flex;
            gap: 12px;
            padding: 16px 20px;
            border-top: 1px solid #e5e7eb;
            border-radius: 0 0 12px 12px;
            background: #f8f9fa;
        }

        .chat-input input {
            flex: 1;
            padding: 10px 16px;
            border: 1px solid #e5e7eb;
            border-radius: 20px;
            outline: none;
            font-size: 14px;
        }

        .chat-input input:focus {
            border-color: #667eea;
        }

        .send-btn {
            width: 36px;
            height: 36px;
            background: #667eea;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        /* Right Panel */
        .report-panel {
            background: white;
            display: flex;
            flex-direction: column;
        }

        .team-tabs {
            background: #f8f9fa;
            border-bottom: 1px solid #e5e7eb;
            padding: 12px 20px 0;
            display: flex;
            gap: 4px;
            overflow-x: auto;
        }

        .team-tab {
            padding: 8px 16px;
            border-radius: 6px 6px 0 0;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            background: white;
            border: 1px solid #e5e7eb;
            border-bottom: none;
            color: #6b7280;
        }

        .team-tab.active {
            background: white;
            color: #667eea;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.1);
        }

        .tab-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #171719;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e5e7eb;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .workspace-container {
                grid-template-columns: 40% 60%;
            }
            
            .hub-sidebar {
                width: 240px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 1000;
                height: 100vh;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .workspace-container {
                grid-template-columns: 1fr;
            }

            .data-source-options {
                grid-template-columns: 1fr;
            }

            .search-input {
                width: 200px;
            }
        }

        /* Loading and Empty States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            flex-direction: column;
            color: #6b7280;
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }

        .empty-state-desc {
            font-size: 14px;
            line-height: 1.5;
        }

        /* 3-Panel Workspace Styles */
        .collaboration-workspace {
            display: grid;
            grid-template-columns: 600px 1fr 640px;
            flex: 1;
            overflow: hidden;
            height: calc(100vh - 120px);
        }

        .team-requests-panel {
            border-right: 1px solid #e9ecef;
            background: #fafbfc;
            padding: 24px;
            overflow-y: auto;
        }

        .team-requests-panel.active {
            display: block;
        }

        .master-data-section {
            background: #f8f9ff;
            border: 1px solid #e0e7ff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .master-data-section:hover {
            background: #f0f4ff;
            border-color: #b3d1ff;
        }

        .team-request-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .team-request-card:hover {
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .team-request-card.active {
            border-color: #667eea;
            background: #f8f9ff;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        .column-item {
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .column-item:hover {
            background: #f3f4f6;
        }

        .column-item.selected {
            background: #e0e7ff !important;
            border: 1px solid #667eea;
        }

        .personal-workspace {
            border-left: 1px solid #e9ecef;
            background: white;
            padding: 24px;
            overflow-y: auto;
        }

        .personal-workspace.active {
            display: block;
        }

        .drop-zone {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 24px;
            text-align: center;
            background: #fafbfc;
            margin-bottom: 20px;
            transition: all 0.2s ease;
        }

        .drop-zone:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        /* Responsive adjustments */
        @media (max-width: 1400px) {
            .collaboration-workspace {
                grid-template-columns: 400px 1fr 400px;
            }
        }

        @media (max-width: 1024px) {
            .collaboration-workspace {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr auto;
            }
            
            .team-requests-panel {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
                max-height: 200px;
            }
            
            .personal-workspace {
                border-left: none;
                border-top: 1px solid #e9ecef;
                max-height: 200px;
            }
        }
        
        /* Related Reports Styles */
        .related-reports-section {
            margin-top: 16px;
        }

        .related-reports-title {
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .related-report-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .related-report-item:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }

        .report-agent-info {
            font-size: 10px;
            color: #6b7280;
            margin-bottom: 2px;
        }

        .report-title {
            font-size: 11px;
            color: #374151;
            font-weight: 500;
        }
    </style>

    <style data-debug="discussion-fix">
        /* 레이아웃 뼈대 */
        html, body { height: 100%; }
        .container    { display: flex; min-height: 100dvh; }
        .main-content { display: flex; flex: 1; min-height: 0; }

        /* 화면 전환 공통 */
        .content-view { display: none; }
        .content-view.active {
            display: flex;
            flex-direction: column;
            flex: 1;           /* ← 자식이 높이 0으로 붕괴되지 않도록 */
            min-height: 0;     /* ← 내부 스크롤 허용 */
        }

        /* 내부 스크롤 영역(파일의 실제 클래스명에 맞춰 확장 가능) */
        .content-body, .content-area, .discussion-body, .report-body {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 0;
            overflow: auto;
        }
    </style>

</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                <div class="logo">SynTitan</div>
                <button class="sidebar-toggle" onclick="toggleSidebar()" style="background: none; border: none; color: #6b7280; cursor: pointer; padding: 6px; border-radius: 4px; transition: all 0.2s ease;" onmouseover="this.style.background='#f3f4f6'; this.style.color='#374151';" onmouseout="this.style.background='none'; this.style.color='#6b7280';">
                    <i class="fas fa-angle-double-left" style="font-size: 14px;"></i>
                </button>
            </div>

            <!-- Navigation -->
            <div class="nav-section">
                <!-- Get Started Group -->
                <div class="nav-group">
                    <div class="nav-group-title">Get Started</div>
                    <div class="nav-item active" onclick="switchView('get-started')">
                        <i class="fas fa-play-circle"></i>
                        <span>Get started</span>
                    </div>
                    <div class="nav-item" onclick="switchView('integration')">
                        <i class="fas fa-plug"></i>
                        <span>Integration</span>
                        <span class="badge soon-badge" style="background: #667eea; color: white; font-size: 9px; padding: 2px 6px; border-radius: 10px; margin-left: 8px;">Soon</span>
                    </div>
                </div>

                <!-- Work Group -->
                <div class="nav-group">
                    <div class="nav-group-title">Work</div>
                    <div class="nav-item" onclick="switchView('workspace')">
                        <i class="fas fa-users"></i>
                        <span>Dataset Workspace</span>
                    </div>
                    <div class="nav-item" onclick="switchView('agent-analysis')">
                        <i class="fas fa-robot"></i>
                        <span>Agent Analysis</span>
                    </div>
                    <div class="nav-item" onclick="switchView('discussion')">
                        <div class="icon-stack" style="position: relative; width: 16px; height: 16px;">
                            <i class="fas fa-chart-bar" style="position: absolute; top: 0; left: 0; font-size: 14px;"></i>
                            <i class="fas fa-comment" style="position: absolute; top: 6px; left: 8px; font-size: 8px; opacity: 0.8;"></i>
                        </div>
                        <span>Integrated Report</span>
                    </div>
                </div>

                <!-- Analyze Group -->
                <div class="nav-group">
                    <div class="nav-group-title">Analyze</div>
                    <div class="nav-item" onclick="switchView('report-hub')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Report Hub</span>
                    </div>
                    <div class="nav-item" onclick="switchView('history')">
                        <i class="fas fa-history"></i>
                        <span>Analysis History</span>
                        <span class="badge">5</span>
                    </div>
                </div>
            </div>

            <!-- Bottom Section -->
            <div class="sidebar-bottom">
                <div class="nav-item" onclick="switchView('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="user-section" onclick="showUserMenu()">
                    <div class="user-avatar">UA</div>
                    <div class="user-info">
                        <div class="user-name">UK An</div>
                        <div class="user-email">uk.an@company.com</div>
                    </div>
                    <i class="fas fa-chevron-up" style="color: #6b7280; font-size: 12px;"></i>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Get Started View -->
            <div class="content-view active" id="get-started-view">
                <div class="get-started-container">
                    <div class="get-started-content">
                        <h1 class="get-started-title">Select Data Source</h1>
                        <p class="get-started-subtitle">
                            Connect your data source to enable secure collaboration.<br>
                            Choose from AWS integration or start with our sample dataset.
                        </p>

                        <div class="data-source-options">
                            <div class="data-source-card" onclick="selectDataSource('aws')">
                                <div class="data-source-icon aws-icon">
                                    <i class="fab fa-aws"></i>
                                </div>
                                <h3 class="data-source-title">AWS Integration</h3>
                                <p class="data-source-desc">
                                    Direct database connection using a standard AWS account
                                </p>
                            </div>
                            <div class="data-source-card" onclick="selectDataSource('demo')">
                                <div class="data-source-icon demo-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <h3 class="data-source-title">Sample Dataset</h3>
                                <p class="data-source-desc">
                                    Ready-to-use demo dataset for testing and exploration
                                </p>
                            </div>
                        </div>

                        <div class="get-started-actions">
                            <button class="btn btn-primary" onclick="proceedWithDataSource()" id="proceedBtn" disabled>
                                <i class="fas fa-arrow-right"></i>
                                Next
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Integration View -->
            <div class="content-view" id="integration-view">
                <div class="content-header">
                    <h1 class="page-title">Data Integration</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary">
                            <i class="fas fa-plus"></i>
                            Add Source
                        </button>
                    </div>
                </div>
                <div class="content-body">
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <h3 class="empty-state-title">No data sources connected</h3>
                        <p class="empty-state-desc">
                            Connect your first data source to start collaborating on data analysis.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Report Hub View -->
            <div class="content-view" id="report-hub-view">
                <div class="content-header">
                    <h1 class="page-title">Report Hub</h1>
                    <div class="report-meta" style="display: flex; gap: 16px; font-size: 13px; color: #6b7280; margin: 8px 0;">
                        <span><i class="fas fa-calendar" style="margin-right: 6px;"></i>Last Updated: September 18, 2025</span>
                        <span><i class="fas fa-chart-bar" style="margin-right: 6px;"></i>15 Analysis Reports</span>
                        <span><i class="fas fa-users" style="margin-right: 6px;"></i>3 Teams Active</span>
                    </div>
                    <div class="header-actions">
                        <input type="text" class="search-input" placeholder="Search reports..." id="hubSearchInput">
                        <button class="btn btn-secondary" style="margin-right: 8px;">
                            <i class="fas fa-download"></i>
                            PDF Export
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-plus"></i>
                            New Analysis
                        </button>
                    </div>
                </div>
                
                <div class="hub-content" style="display: grid; grid-template-columns: 280px 1fr; gap: 24px; padding: 32px; height: calc(100vh - 120px);">
                    <!-- Sidebar Filters -->
                    <div class="hub-sidebar" style="background: #f8f9fa; border-radius: 12px; padding: 24px; border: 1px solid #e5e7eb; overflow-y: auto;">
                        <div class="filter-section" style="margin-bottom: 24px;">
                            <h3 class="filter-section-title" style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 16px;">Filters</h3>
                        </div>

                        <div class="filters-list">
                            <!-- Team Filters -->
                            <div class="filter-group" style="margin-bottom: 20px;">
                                <div class="filter-group-title" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                                    Teams
                                    <span class="filter-count" style="background: #e5e7eb; color: #6b7280; padding: 2px 6px; border-radius: 4px; font-size: 12px;">4</span>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'team', 'integrated')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Integrated Analysis</div>
                                    <div class="filter-badge">4</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'team', 'marketing')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Marketing Team</div>
                                    <div class="filter-badge">3</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'team', 'finance')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Finance Team</div>
                                    <div class="filter-badge">1</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'team', 'sales')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Sales Team</div>
                                    <div class="filter-badge">2</div>
                                </div>
                            </div>

                            <!-- Module Filters -->
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    Analysis Modules
                                    <span class="filter-count">6</span>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'integrated')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Integrated Analysis</div>
                                    <div class="filter-badge">8</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'segmentation')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Segmentation</div>
                                    <div class="filter-badge">3</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'prediction')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Prediction Analysis</div>
                                    <div class="filter-badge">2</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'roi')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">ROI Analysis</div>
                                    <div class="filter-badge">2</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'behavior')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Behavior Analysis</div>
                                    <div class="filter-badge">1</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'module', 'campaign')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Campaign Analysis</div>
                                    <div class="filter-badge">1</div>
                                </div>
                            </div>

                            <!-- Period Filters -->
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    Created
                                    <span class="filter-count">5</span>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'period', 'today')">
                                    <div class="filter-checkbox"></div>
                                    <div class="filter-label">Today</div>
                                    <div class="filter-badge">3</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'period', 'week')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">This week</div>
                                    <div class="filter-badge">3</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'period', 'month')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">This month</div>
                                    <div class="filter-badge">9</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'period', 'quarter')">
                                    <div class="filter-checkbox"></div>
                                    <div class="filter-label">This quarter</div>
                                    <div class="filter-badge">8</div>
                                </div>
                            </div>

                            <!-- Status Filters -->
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    Status
                                    <span class="filter-count">3</span>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'status', 'latest')">
                                    <div class="filter-checkbox checked"></div>
                                    <div class="filter-label">Latest Version</div>
                                    <div class="filter-badge">9</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'status', 'versioned')">
                                    <div class="filter-checkbox"></div>
                                    <div class="filter-label">Version Managed</div>
                                    <div class="filter-badge">6</div>
                                </div>
                                <div class="filter-item" onclick="toggleFilter(this, 'status', 'deprecated')">
                                    <div class="filter-checkbox"></div>
                                    <div class="filter-label">Previous Version</div>
                                    <div class="filter-badge">2</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="hub-main" style="background: white; border-radius: 12px; border: 1px solid #e5e7eb; overflow: hidden; display: flex; flex-direction: column;">
                        <div class="content-controls" style="display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid #f3f4f6; background: #f8f9fa;">
                            <div class="view-toggle" style="display: flex; gap: 4px;">
                                <button class="view-btn active" onclick="switchReportView('list')" style="display: flex; align-items: center; gap: 8px; padding: 8px 16px; border: 1px solid #e5e7eb; border-radius: 6px; background: white; font-size: 14px; font-weight: 500; color: #667eea; cursor: pointer;">
                                    <i class="fas fa-list"></i>
                                    List
                                </button>
                                <button class="view-btn" onclick="switchReportView('compare')" id="compareBtn" style="display: flex; align-items: center; gap: 8px; padding: 8px 16px; border: 1px solid #e5e7eb; border-radius: 6px; background: transparent; font-size: 14px; font-weight: 500; color: #6b7280; cursor: pointer;">
                                    <i class="fas fa-search"></i>
                                    Compare (<span id="compareCount">0</span>)
                                </button>
                            </div>
                            <select class="sort-select" id="sortSelect" style="padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 6px; background: white; font-size: 14px; color: #374151;">
                                <option value="date-desc">Newest first</option>
                                <option value="date-asc">Oldest first</option>
                                <option value="name-asc">Name A-Z</option>
                                <option value="team-asc">By team</option>
                                <option value="module-asc">By module</option>
                            </select>
                        </div>

                        <div class="content-body" style="flex: 1; padding: 24px; overflow-y: auto;">
                            <!-- Integrated Analysis View -->
                            <div class="integrated-analysis-view" id="integratedView">
                                <!-- Team Collaboration Status -->
                                <div class="collaboration-status" style="background: #f8f9ff; border: 1px solid #e0e7ff; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <h3 style="color: #1d1d1f; font-size: 16px; font-weight: 600;">
                                            <i class="fas fa-users" style="margin-right: 8px; color: #667eea;"></i>Team Collaboration Status
                                        </h3>
                                        <div style="display: flex; gap: 8px;">
                                            <div class="user-avatar" style="width: 24px; height: 24px; background: #10b981; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px;">M</div>
                                            <div class="user-avatar" style="width: 24px; height: 24px; background: #f59e0b; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px;">F</div>
                                            <div class="user-avatar" style="width: 24px; height: 24px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px;">S</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #6e6e73;">Cross-team analysis alignment: <strong style="color: #10b981;">96%</strong> • Cross-validation completion: <strong style="color: #10b981;">100%</strong></div>
                                </div>

                                <!-- Key Insights Grid -->
                                <div class="insights-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div class="insight-card" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <div style="width: 32px; height: 32px; background: #10b981; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                                <i class="fas fa-chart-line" style="color: white; font-size: 14px;"></i>
                                            </div>
                                            <div>
                                                <div style="font-size: 14px; font-weight: 600; color: #1d1d1f;">Marketing ROI</div>
                                                <div style="font-size: 12px; color: #6e6e73;">Customer Analysis</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 20px; font-weight: 700; color: #10b981;">324%</div>
                                        <div style="font-size: 11px; color: #6e6e73;">98% match with finance data</div>
                                    </div>

                                    <div class="insight-card" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <div style="width: 32px; height: 32px; background: #f59e0b; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                                <i class="fas fa-dollar-sign" style="color: white; font-size: 14px;"></i>
                                            </div>
                                            <div>
                                                <div style="font-size: 14px; font-weight: 600; color: #1d1d1f;">Revenue Projection</div>
                                                <div style="font-size: 12px; color: #6e6e73;">Finance Analysis</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 20px; font-weight: 700; color: #f59e0b;">$215M</div>
                                        <div style="font-size: 11px; color: #6e6e73;">92% reliability confirmed</div>
                                    </div>

                                    <div class="insight-card" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <div style="width: 32px; height: 32px; background: #667eea; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                                <i class="fas fa-users" style="color: white; font-size: 14px;"></i>
                                            </div>
                                            <div>
                                                <div style="font-size: 14px; font-weight: 600; color: #1d1d1f;">Customer LTV</div>
                                                <div style="font-size: 12px; color: #6e6e73;">Sales Analysis</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 20px; font-weight: 700; color: #667eea;">$3.73K</div>
                                        <div style="font-size: 11px; color: #6e6e73;">Lifetime Value Analysis</div>
                                    </div>
                                </div>

                                <!-- Reports List -->
                                <div class="reports-list" id="reportsList">
                                    <!-- Reports will be dynamically generated -->
                                </div>
                            </div>

                            <!-- Compare View -->
                            <div class="comparison-view" id="comparisonView" style="display: none;">
                                <div class="comparison-header">
                                    <h3 style="margin-bottom: 16px;">Report Comparison Analysis</h3>
                                    <div class="selected-reports" id="selectedReports">
                                        <!-- Selected reports will be shown here -->
                                    </div>
                                </div>
                                <div class="comparison-grid" id="comparisonGrid">
                                    <!-- Comparison cards will be shown here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workspace View -->
            <div class="content-view" id="workspace-view">
                <div class="content-header">
                    <h1 class="page-title">Dataset Workspace</h1>
                    <div class="header-actions">
                        <div style="display: flex; gap: 16px; align-items: center; font-size: 14px; color: #6b7280;">
                            <div><strong style="color: #171719;">4.8GB</strong> Master Data</div>
                            <div><strong style="color: #171719;">3</strong> Active Teams</div>
                            <div><strong style="color: #171719;">12</strong> Requests</div>
                        </div>
                    </div>
                </div>

                <div class="collaboration-workspace" id="workspace" style="display: grid; grid-template-columns: 600px 1fr 640px; flex: 1; overflow: hidden; height: calc(100vh - 120px);">
                    <!-- Left Panel - Data Explorer -->
                    <div class="team-requests-panel active" id="team-panel" style="border-right: 1px solid #e9ecef; background: #fafbfc; padding: 24px; overflow-y: auto;">
                        <div class="panel-header">
                            <div class="panel-title" style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 16px;">Data Explorer</div>
                        </div>

                        <!-- Master Data Section -->
                        <div class="master-data-section" onclick="selectMasterData()" style="background: #f8f9ff; border: 1px solid #e0e7ff; border-radius: 12px; padding: 16px; margin-bottom: 20px; cursor: pointer;">
                            <div class="master-data-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                <div class="master-data-icon" style="font-size: 16px; color: #667eea;"><i class="fas fa-database"></i></div>
                                <div class="master-data-title" style="font-weight: 600; color: #1d1d1f;">Master Data</div>
                            </div>
                            <div class="master-data-stats" style="display: flex; gap: 16px; margin-bottom: 8px;">
                                <div class="master-stat" style="font-size: 12px; color: #6e6e73;"><strong>4.8GB</strong> Processed</div>
                                <div class="master-stat" style="font-size: 12px; color: #6e6e73;"><strong>96%</strong> Quality Maintained</div>
                            </div>
                            <div class="master-data-desc" style="font-size: 11px; color: #8e8e93; line-height: 1.4;">
                                DTS security-processed master dataset<br>
                                enables secure team collaboration
                            </div>
                        </div>
                        
                        <!-- Team Data Requests -->
                        <div class="team-requests">
                            <div class="section-title" style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Team Data Status</div>
                            
                            <div class="team-request-card" onclick="selectTeamData('marketing')" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease;">
                                <div class="team-info" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <div class="team-avatar team-marketing" style="width: 24px; height: 24px; background: #ff6b6b; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;"><i class="fas fa-chart-line"></i></div>
                                    <div class="team-name" style="font-weight: 600; color: #1d1d1f;">Marketing Team</div>
                                </div>
                                <div class="request-purpose" style="font-size: 13px; color: #6e6e73; margin-bottom: 8px;">Campaign effectiveness analysis</div>
                                <div class="request-details" style="display: flex; justify-content: space-between; align-items: center;">
                                    <div class="data-format" style="font-size: 11px; color: #8e8e93;">CSV Export</div>
                                    <div class="dataset-date" style="font-size: 11px; color: #8e8e93;">2024-01-15</div>
                                </div>
                            </div>

                            <div class="team-request-card" onclick="selectTeamData('finance')" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease;">
                                <div class="team-info" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <div class="team-avatar team-finance" style="width: 24px; height: 24px; background: #4ecdc4; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;"><i class="fas fa-dollar-sign"></i></div>
                                    <div class="team-name" style="font-weight: 600; color: #1d1d1f;">Finance Team</div>
                                </div>
                                <div class="request-purpose" style="font-size: 13px; color: #6e6e73; margin-bottom: 8px;">Monthly summary reports</div>
                                <div class="request-details" style="display: flex; justify-content: space-between; align-items: center;">
                                    <div class="data-format" style="font-size: 11px; color: #8e8e93;">Excel Export</div>
                                    <div class="dataset-date" style="font-size: 11px; color: #8e8e93;">2024-01-14</div>
                                </div>
                            </div>

                            <div class="team-request-card" onclick="selectTeamData('sales')" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease;">
                                <div class="team-info" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <div class="team-avatar team-sales" style="width: 24px; height: 24px; background: #45b7d1; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;"><i class="fas fa-bullseye"></i></div>
                                    <div class="team-name" style="font-weight: 600; color: #1d1d1f;">Sales Team</div>
                                </div>
                                <div class="request-purpose" style="font-size: 13px; color: #6e6e73; margin-bottom: 8px;">Customer segment analysis</div>
                                <div class="request-details" style="display: flex; justify-content: space-between; align-items: center;">
                                    <div class="data-format" style="font-size: 11px; color: #8e8e93;">Report Format</div>
                                    <div class="dataset-date" style="font-size: 11px; color: #8e8e93;">2024-01-13</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Central Panel - Editing Studio -->
                    <div class="collaboration-main" style="background: white; display: flex; flex-direction: column; overflow: hidden;">
                        <!-- Central Panel Title -->
                        <div class="central-panel-title" id="central-panel-title" style="background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%); border-bottom: 1px solid #e9ecef; padding: 20px 24px; text-align: center;">
                            <div class="central-title" style="font-size: 24px; font-weight: 700; color: #1d1d1f; margin-bottom: 8px;">Editing Studio</div>
                            <div class="central-subtitle" style="font-size: 14px; color: #6e6e73;">Integrated workspace for data exploration and editing</div>
                        </div>
                        
                        <!-- Empty State Message -->
                        <div class="empty-state" id="empty-state" style="display: flex; flex: 1; align-items: center; justify-content: center; flex-direction: column; background: #fafbfc;">
                            <div class="empty-state-content" style="text-align: center;">
                                <div class="empty-state-icon" style="font-size: 48px; margin-bottom: 16px; color: #9ca3af;"><i class="fas fa-folder-open"></i></div>
                                <div class="empty-state-title" style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Please select a dataset</div>
                                <div class="empty-state-desc" style="font-size: 14px; color: #6e6e73; line-height: 1.6;">Select master data or team-specific data from the left panel<br>to start editing operations</div>
                            </div>
                        </div>
                        
                        <!-- Column Selection Interface (Hidden initially) -->
                        <div class="column-selection-interface" id="column-interface" style="display: none; flex: 1; flex-direction: column; height: 100%;">
                            <div class="interface-header" style="padding: 24px 24px 16px 24px; border-bottom: 1px solid #e9ecef; flex-shrink: 0;">
                                <div class="selected-dataset-info" style="background: #f8f9ff; border: 1px solid #e0e7ff; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                    <div class="dataset-name" style="font-weight: 600; color: #1d1d1f; margin-bottom: 4px;">Master Dataset - Customer Analytics</div>
                                    <div class="dataset-meta" style="font-size: 12px; color: #6e6e73;">247 columns • 1.2M rows • Last updated 2 hours ago</div>
                                </div>
                                
                                <!-- Select All Controls -->
                                <div class="select-all-controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="selectAllColumns" onchange="toggleSelectAll()" style="margin: 0;">
                                        <label for="selectAllColumns" style="font-weight: 500; color: #1d1d1f; margin: 0;">Select All Columns</label>
                                    </div>
                                    <div style="font-size: 12px; color: #6e6e73;">
                                        <span id="selectedCount">0</span> / <span id="totalCount">38</span> selected
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Column List -->
                            <div class="column-list-wrapper" style="flex: 1; padding: 16px 24px; overflow-y: auto;">
                            <div class="column-list-container" style="border: 1px solid #e9ecef; border-radius: 8px; background: white;">
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="customer_id" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">customer_id</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('customer_id')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('customer_id')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="customer_name" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">customer_name</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('customer_name')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('customer_name')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="email" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">email</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('email')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('email')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="phone" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">phone</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('phone')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('phone')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="age" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">age</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Number)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('age')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('age')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="gender" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">gender</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('gender')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('gender')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="address" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">address</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Text)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('address')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('address')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="city" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">city</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('city')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('city')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="country" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">country</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('country')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('country')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="purchase_date" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">purchase_date</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Date)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('purchase_date')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('purchase_date')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="amount" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">amount</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Number)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('amount')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('amount')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="product_category" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">product_category</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('product_category')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('product_category')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="product_name" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">product_name</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('product_name')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('product_name')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="quantity" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">quantity</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Number)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('quantity')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('quantity')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="payment_method" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">payment_method</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('payment_method')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('payment_method')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="discount_rate" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">discount_rate</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(Number)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('discount_rate')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('discount_rate')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="order_status" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">order_status</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(String)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('order_status')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('order_status')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                                
                                <div class="column-item" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; font-size: 13px;">
                                    <input type="checkbox" class="column-checkbox" data-column="last_login_date" onchange="toggleColumn(this)">
                                    <div class="column-info" style="flex: 1;">
                                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">last_login_date</span>
                                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(DateTime)</span>
                                    </div>
                                    <button class="alias-btn" onclick="showAliasDialog('last_login_date')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                                    <button class="desc-btn" onclick="showDescDialog('last_login_date')" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                                </div>
                            </div>
                            </div>
                            
                        </div>
                    </div>

                    <!-- Right Panel - Team Workspace -->
                    <div class="personal-workspace active" id="personal-workspace" style="border-left: 1px solid #e9ecef; background: white; padding: 24px; overflow-y: auto;">
                        <div class="workspace-header-personal" style="margin-bottom: 20px;">
                            <div class="workspace-title-personal" style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Team Work Dataset</div>
                            <div class="workspace-subtitle-personal" style="font-size: 12px; color: #6e6e73;">Create team-customized datasets from selected columns</div>
                        </div>

                        <div class="selected-columns" id="selected-columns">
                            <!-- Selected columns will be displayed here -->
                        </div>

                        <!-- Synthetic Data Augmentation Section -->
                        <div class="synthetic-data-section" style="background: #f8f9fa; border-radius: 12px; padding: 16px; margin: 16px 0; border: 1px solid #e9ecef;">
                            <div class="workspace-title-personal" style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;"><i class="fas fa-flask" style="margin-right: 8px; color: #667eea;"></i>Synthetic Data Augmentation</div>
                            <div class="synthetic-options" style="display: flex; gap: 16px; margin-bottom: 12px;">
                                <div class="synthetic-option" onclick="selectSyntheticOption('none')" style="cursor: pointer;">
                                    <input type="radio" name="synthetic" id="none" checked style="margin-right: 6px;">
                                    <label for="none" style="font-size: 13px; cursor: pointer;">None</label>
                                </div>
                                <div class="synthetic-option" onclick="selectSyntheticOption('enable')" style="cursor: pointer;">
                                    <input type="radio" name="synthetic" id="enable" style="margin-right: 6px;">
                                    <label for="enable" style="font-size: 13px; cursor: pointer;">Enable Augmentation</label>
                                </div>
                            </div>
                            
                            <!-- Augmentation Detail Options -->
                            <div class="augment-detail-options" id="augmentDetailOptions" style="display: none;">
                                <div class="augment-detail-title" style="font-size: 12px; color: #6e6e73; margin-bottom: 8px;">Select Augmentation Methods (Multiple Selection Available)</div>
                                <div class="augment-methods" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div class="augment-method">
                                        <input type="checkbox" id="crawling" onchange="updateAugmentMethod()" style="margin-right: 4px;">
                                        <label for="crawling" style="font-size: 12px; cursor: pointer;">Crawling-based</label>
                                    </div>
                                    <div class="augment-method">
                                        <input type="checkbox" id="row" onchange="updateAugmentMethod()" style="margin-right: 4px;">
                                        <label for="row" style="font-size: 12px; cursor: pointer;">Row-based</label>
                                    </div>
                                    <div class="augment-method">
                                        <input type="checkbox" id="missing" onchange="updateAugmentMethod()" style="margin-right: 4px;">
                                        <label for="missing" style="font-size: 12px; cursor: pointer;">Missing Value Completion</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Request Notification -->
                            <div class="request-notification" id="requestNotification" style="display: none; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 12px; margin-top: 12px;">
                                <div class="notification-text" style="font-size: 12px; color: #856404; margin-bottom: 8px;">
                                    Data augmentation requires additional processing time.<br>
                                    Please provide a notification channel for background operations.
                                </div>
                                <div class="notification-channels" style="display: flex; gap: 8px;">
                                    <div class="channel-option">
                                        <input type="checkbox" id="email" checked style="margin-right: 4px;">
                                        <label for="email" style="font-size: 11px; cursor: pointer;"><i class="fas fa-envelope" style="margin-right: 4px;"></i>Email</label>
                                    </div>
                                    <div class="channel-option">
                                        <input type="checkbox" id="sms" style="margin-right: 4px;">
                                        <label for="sms" style="font-size: 11px; cursor: pointer;"><i class="fas fa-sms" style="margin-right: 4px;"></i>SMS</label>
                                    </div>
                                    <div class="channel-option">
                                        <input type="checkbox" id="push" style="margin-right: 4px;">
                                        <label for="push" style="font-size: 11px; cursor: pointer;"><i class="fas fa-bell" style="margin-right: 4px;"></i>Push</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="workspace-actions" style="margin: 16px 0;">
                            <button class="btn btn-primary" id="generateBtn" onclick="generateData()" style="width: 100%; background: #667eea; color: white; border: none; padding: 12px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer;">
                                <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>
                                Create Team Dataset
                            </button>
                        </div>

                        <!-- Duplicate Prevention System -->
                        <div class="duplicate-check-section" id="duplicate-check-section" style="background: #f8f9ff; border: 1px solid #e0e7ff; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <div class="duplicate-check-title" style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">
                                <i class="fas fa-search" style="margin-right: 8px; color: #667eea;"></i>Real-time Duplication Check
                            </div>
                            
                            <!-- Duplicate Rate Display Area -->
                            <div class="duplicate-indicator" id="duplicate-indicator" style="background: white; border-radius: 6px; padding: 12px;">
                                <div style="text-align: center; color: #6e6e73; font-size: 13px; padding: 20px;">
                                    <i class="fas fa-search" style="font-size: 24px; margin-bottom: 8px; color: #9ca3af;"></i>
                                    <div>No columns selected</div>
                                    <div style="font-size: 11px; margin-top: 4px;">Select columns to check for duplications</div>
                                </div>
                            </div>

                            <!-- Related Reports Section -->
                            <div class="related-reports-section" id="related-reports-section" style="display: none; margin-top: 12px;">
                                <div class="related-reports-title" style="font-size: 12px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">
                                    <i class="fas fa-chart-bar" style="margin-right: 6px; color: #667eea;"></i>Related Column Report
                                </div>
                                <div id="related-reports-container">
                                    <!-- Related reports will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

                        <!-- Integrated Discussion View -->
            <div class="content-view" id="discussion-view">
                <div class="content-header">
                    <h1 class="page-title">Integrated Analysis Report</h1>
                    <div class="report-meta" style="display: flex; gap: 16px; font-size: 12px; color: #6e6e73; margin: 8px 0;">
                        <span><i class="fas fa-calendar" style="margin-right: 4px;"></i>September 18, 2025</span>
                        <span><i class="fas fa-users" style="margin-right: 4px;"></i>3 Teams Collaboration Complete</span>
                        <span><i class="fas fa-sync" style="margin-right: 4px; color: #10b981;"></i>Real-time Updates</span>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-secondary">
                            <i class="fas fa-download"></i>
                            Export PDF
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-share"></i>
                            Share
                        </button>
                    </div>
                </div>
                
                <!-- Report Workspace with Chat and Tabs -->
                <div class="report-workspace" style="display: grid; grid-template-columns: 35% 65%; height: calc(100vh - 120px); gap: 0;">
                    <!-- Left: Team Collaboration Panel -->
                    <div class="team-collaboration-panel" style="background: #f8f9fa; border-right: 1px solid #e9ecef; display: flex; flex-direction: column;">
                        <!-- Active Users Display -->
                        <div class="active-users" style="background: white; border-bottom: 1px solid #e9ecef; padding: 16px 20px;">
                            <div style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-users" style="color: #667eea;"></i>Currently Online
                            </div>
                            <div style="display: flex; gap: 12px;">
                                <div style="display: flex; align-items: center; gap: 8px; background: #10b981; color: white; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600;">
                                    <div style="width: 8px; height: 8px; background: #34d399; border-radius: 50%;"></div>
                                    M
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; background: #f59e0b; color: white; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600;">
                                    <div style="width: 8px; height: 8px; background: #fbbf24; border-radius: 50%;"></div>
                                    F
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; background: #667eea; color: white; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600;">
                                    <div style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;"></div>
                                    S
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Chat -->
                        <div class="team-chat-container" style="flex: 1; display: flex; flex-direction: column; background: white; margin: 16px; border-radius: 12px; border: 1px solid #e9ecef;">
                            <div class="chat-header" style="background: #f8f9fa; padding: 16px 20px; border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0;">
                                <div style="font-size: 14px; font-weight: 600; color: #1d1d1f; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-comments" style="color: #667eea;"></i>Real-time Verification & Discussion
                                </div>
                            </div>

                            <div class="chat-messages" id="reportChatMessages" style="flex: 1; padding: 16px 20px; overflow-y: auto;">
                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">S</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Sales Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:15</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        Confirmed AI analysis results. Premium strategy direction matches our team's conclusion! 👍
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #10b981; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">M</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Marketing Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:17</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        Happy that customer analysis expertise was validated with 324% ROI. 98% match with finance team data!
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #10b981; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">M</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Marketing Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:17</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        High-value customer segment analysis (top 23%) is truly insightful! 324% ROI improvement potential looks solid 🎯
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #f59e0b; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">F</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Finance Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:19</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        Profitability analysis shows accurate calculation of $215M expected revenue. 92% reliability makes it executable 📊
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #10b981; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">M</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Marketing Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:21</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        @Finance Team Right! Especially with Digital Marketing channel (425% ROI) budget reallocation - synergy will be huge 💪
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">S</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Sales Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:23</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        Improving Qualified Lead → Proposal conversion from 65% to 75% is realistic too. We can execute right away! 🚀
                                    </div>
                                </div>

                                <div class="message" style="margin-bottom: 16px;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <div style="width: 24px; height: 24px; background: #f59e0b; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">F</div>
                                        <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Finance Team</span>
                                        <span style="font-size: 11px; color: #8e8e93;">10:25</span>
                                    </div>
                                    <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">
                                        Let's create a 3-team integrated execution plan! Expected synergy of 65% performance improvement is worth the challenge ⭐
                                    </div>
                                </div>

                            </div>

                            <div class="chat-input" style="display: flex; gap: 12px; padding: 16px 20px; border-top: 1px solid #e9ecef; border-radius: 0 0 12px 12px; background: #f8f9fa;">
                                <input type="text" id="reportMessageInput" placeholder="Enter your discussion message..." style="flex: 1; padding: 12px 16px; border: 1px solid #e9ecef; border-radius: 24px; outline: none; font-size: 14px;">
                                <button onclick="sendDiscussionMessage()" style="width: 40px; height: 40px; background: #667eea; border: none; border-radius: 50%; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Report Content with Tabs -->
                    <div class="report-content-panel" style="background: white; display: flex; flex-direction: column;">
                        <!-- Team Tab Navigation -->
                        <div class="report-tabs" style="background: #f8f9fa; border-bottom: 1px solid #e9ecef; padding: 16px 24px 0; display: flex; gap: 4px; overflow-x: auto;">
                            <div class="report-tab active" onclick="switchDiscussionTab('integrated')" style="padding: 12px 20px; border-radius: 8px 8px 0 0; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; background: white; border: 1px solid #e9ecef; border-bottom: none; color: #667eea; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(102, 126, 234, 0.1);">
                                <i class="fas fa-link" style="margin-right: 6px;"></i>Integrated Insights
                            </div>
                            <div class="report-tab" onclick="switchDiscussionTab('marketing')" style="padding: 12px 20px; border-radius: 8px 8px 0 0; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; background: white; border: 1px solid #e9ecef; border-bottom: none; color: #6e6e73;">
                                <i class="fas fa-chart-line" style="margin-right: 6px;"></i>Marketing Team
                            </div>
                            <div class="report-tab" onclick="switchDiscussionTab('finance')" style="padding: 12px 20px; border-radius: 8px 8px 0 0; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; background: white; border: 1px solid #e9ecef; border-bottom: none; color: #6e6e73;">
                                <i class="fas fa-dollar-sign" style="margin-right: 6px;"></i>Finance Team
                            </div>
                            <div class="report-tab" onclick="switchDiscussionTab('sales')" style="padding: 12px 20px; border-radius: 8px 8px 0 0; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; background: white; border: 1px solid #e9ecef; border-bottom: none; color: #6e6e73;">
                                <i class="fas fa-users" style="margin-right: 6px;"></i>Sales Team
                            </div>
                        </div>

                        <!-- Tab Content -->
                        <div class="tab-content-container" style="flex: 1; overflow-y: auto;">
                            <!-- Integrated Insights Tab -->
                            <div class="report-tab-content active" id="integrated-content" style="padding: 32px; display: block;">
                                <h3 style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-link" style="color: #667eea;"></i>3-Team Integrated Analysis Results
                                </h3>

                                <!-- Trust & Reliability Overview -->
                                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-shield-check" style="color: #10b981;"></i>Analysis Reliability Overview
                                    </h4>
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 18px; font-weight: 700; color: #10b981;">96%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Data Quality</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 18px; font-weight: 700; color: #667eea;">98%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Team Consensus</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 18px; font-weight: 700; color: #f59e0b;">94%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Model Accuracy</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 18px; font-weight: 700; color: #ef4444;">92%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Validation Score</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Key Metrics -->
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: #15803d;">324%</div>
                                        <div style="font-size: 12px; color: #6b7280;">Marketing ROI</div>
                                    </div>
                                    <div style="background: #fffbeb; border: 1px solid #fed7aa; border-radius: 8px; padding: 16px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: #ea580c;">$215M</div>
                                        <div style="font-size: 12px; color: #6b7280;">Revenue Projection</div>
                                    </div>
                                    <div style="background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px; padding: 16px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: #0369a1;">$3.73K</div>
                                        <div style="font-size: 12px; color: #6b7280;">Average Customer LTV</div>
                                    </div>
                                </div>

                                <!-- Strategy Comparison Cards (F&B Style) -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; margin-bottom: 32px;">
                                    <div style="background: linear-gradient(135deg, #667eea20, #764ba220); border: 1px solid #e0e7ff; border-radius: 12px; padding: 20px; position: relative;">
                                        <div style="position: absolute; top: 12px; right: 12px; background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Premium</div>
                                        <h4 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Digital Marketing Focus</h4>
                                        <div style="font-size: 13px; color: #6e6e73; line-height: 1.6; margin-bottom: 16px;">Concentrate budget on high-performance digital channels with proven 425% ROI track record and precise targeting capabilities.</div>
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                                            <div style="text-align: center; padding: 8px; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #10b981;">425%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Expected ROI</div>
                                            </div>
                                            <div style="text-align: center; padding: 8px; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #10b981;">$2.1M</div>
                                                <div style="font-size: 10px; color: #6b7280;">Revenue Impact</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 12px; color: #8e8e93;">Risk Level: Low • Implementation: 2 weeks</div>
                                    </div>

                                    <div style="background: linear-gradient(135deg, #f59e0b20, #ea580c20); border: 1px solid #fed7aa; border-radius: 12px; padding: 20px; position: relative;">
                                        <div style="position: absolute; top: 12px; right: 12px; background: #f59e0b; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Balanced</div>
                                        <h4 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Omnichannel Approach</h4>
                                        <div style="font-size: 13px; color: #6e6e73; line-height: 1.6; margin-bottom: 16px;">Diversify across multiple channels to reduce risk while maintaining stable growth with integrated customer experience.</div>
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                                            <div style="text-align: center; padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #f59e0b;">285%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Expected ROI</div>
                                            </div>
                                            <div style="text-align: center; padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #f59e0b;">$1.8M</div>
                                                <div style="font-size: 10px; color: #6b7280;">Revenue Impact</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 12px; color: #8e8e93;">Risk Level: Medium • Implementation: 4 weeks</div>
                                    </div>

                                    <div style="background: linear-gradient(135deg, #10b98120, #059e6920); border: 1px solid #bbf7d0; border-radius: 12px; padding: 20px; position: relative;">
                                        <div style="position: absolute; top: 12px; right: 12px; background: #6b7280; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Conservative</div>
                                        <h4 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Traditional + Innovation</h4>
                                        <div style="font-size: 13px; color: #6e6e73; line-height: 1.6; margin-bottom: 16px;">Maintain proven traditional methods while gradually introducing innovative approaches for sustainable growth.</div>
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                                            <div style="text-align: center; padding: 8px; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #10b981;">215%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Expected ROI</div>
                                            </div>
                                            <div style="text-align: center; padding: 8px; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
                                                <div style="font-size: 18px; font-weight: 700; color: #10b981;">$1.4M</div>
                                                <div style="font-size: 10px; color: #6b7280;">Revenue Impact</div>
                                            </div>
                                        </div>
                                        <div style="font-size: 12px; color: #8e8e93;">Risk Level: Low • Implementation: 6 weeks</div>
                                    </div>
                                </div>

                                <!-- Performance Analysis Dashboard -->
                                <div style="background: white; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin: 24px 0; border: 1px solid #e5e7eb; grid-column: 1 / -1;">
                                    <h3 style="color: #2c2c2c; font-size: 18px; font-weight: 600; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-bar" style="color: #667eea;"></i>Performance Analysis Dashboard
                                    </h3>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px;">
                                        <!-- Revenue Growth Chart -->
                                        <div style="background: #f8f9fa; border-radius: 8px; padding: 16px; border: 1px solid #e9ecef;">
                                            <h4 style="color: #495057; font-size: 14px; font-weight: 600; margin-bottom: 12px;">Monthly Revenue Growth</h4>
                                            <div style="position: relative; height: 120px; background: white; border-radius: 6px; padding: 12px; border: 1px solid #e9ecef;">
                                                <div style="position: absolute; top: 8px; right: 8px; background: #28a745; color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500;">+28% YoY</div>
                                                <!-- Bar Chart Simulation -->
                                                <div style="display: flex; align-items: end; justify-content: space-between; height: 80px; margin-top: 16px;">
                                                    <div style="width: 20px; background: #667eea; height: 50%; border-radius: 2px 2px 0 0; position: relative;">
                                                        <div style="position: absolute; top: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #6e6e73; font-weight: 500;">72%</div>
                                                        <div style="position: absolute; bottom: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #8e8e93;">Jan</div>
                                                    </div>
                                                    <div style="width: 20px; background: #28a745; height: 70%; border-radius: 2px 2px 0 0; position: relative;">
                                                        <div style="position: absolute; top: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #6e6e73; font-weight: 500;">89%</div>
                                                        <div style="position: absolute; bottom: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #8e8e93;">Feb</div>
                                                    </div>
                                                    <div style="width: 20px; background: #ffc107; height: 55%; border-radius: 2px 2px 0 0; position: relative;">
                                                        <div style="position: absolute; top: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #6e6e73; font-weight: 500;">76%</div>
                                                        <div style="position: absolute; bottom: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #8e8e93;">Mar</div>
                                                    </div>
                                                    <div style="width: 20px; background: #dc3545; height: 80%; border-radius: 2px 2px 0 0; position: relative;">
                                                        <div style="position: absolute; top: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #6e6e73; font-weight: 500;">94%</div>
                                                        <div style="position: absolute; bottom: -16px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #8e8e93;">Apr</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Customer Satisfaction Trend -->
                                        <div style="background: #f8f9fa; border-radius: 8px; padding: 16px; border: 1px solid #e9ecef;">
                                            <h4 style="color: #495057; font-size: 14px; font-weight: 600; margin-bottom: 12px;">Customer Satisfaction Trend</h4>
                                            <div style="position: relative; height: 120px; background: white; border-radius: 6px; padding: 12px; border: 1px solid #e9ecef;">
                                                <div style="position: absolute; top: 8px; right: 8px; background: #28a745; color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500;">91% Avg</div>
                                                <!-- Trend Line Graph with Variations -->
                                                <div style="position: relative; height: 80px; margin-top: 16px;">
                                                    <svg width="100%" height="80" style="position: absolute; top: 0; left: 0;">
                                                        <!-- Grid lines -->
                                                        <line x1="0" y1="20" x2="100%" y2="20" stroke="#f3f4f6" stroke-width="1"/>
                                                        <line x1="0" y1="40" x2="100%" y2="40" stroke="#f3f4f6" stroke-width="1"/>
                                                        <line x1="0" y1="60" x2="100%" y2="60" stroke="#f3f4f6" stroke-width="1"/>
                                                        <!-- Trend line with variations -->
                                                        <polyline points="10,45 35,25 60,35 85,20" fill="none" stroke="#28a745" stroke-width="2" stroke-linecap="round"/>
                                                        <!-- Data points -->
                                                        <circle cx="10" cy="45" r="4" fill="#28a745"/>
                                                        <circle cx="35" cy="25" r="4" fill="#f59e0b"/>
                                                        <circle cx="60" cy="35" r="4" fill="#667eea"/>
                                                        <circle cx="85" cy="20" r="4" fill="#10b981"/>
                                                        <!-- Value labels -->
                                                        <text x="10" y="42" text-anchor="middle" style="font-size: 10px; fill: #6b7280; font-weight: 600;">87%</text>
                                                        <text x="35" y="22" text-anchor="middle" style="font-size: 10px; fill: #6b7280; font-weight: 600;">94%</text>
                                                        <text x="60" y="32" text-anchor="middle" style="font-size: 10px; fill: #6b7280; font-weight: 600;">89%</text>
                                                        <text x="85" y="17" text-anchor="middle" style="font-size: 10px; fill: #6b7280; font-weight: 600;">96%</text>
                                                    </svg>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; margin-top: 8px; padding: 0 5px;">
                                                    <span style="font-size: 10px; color: #8e8e93;">Jan</span>
                                                    <span style="font-size: 10px; color: #8e8e93;">Feb</span>
                                                    <span style="font-size: 10px; color: #8e8e93;">Mar</span>
                                                    <span style="font-size: 10px; color: #8e8e93;">Apr</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Cross-team Synergy Effects -->
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Cross-team Synergy Effects</h4>
                                    <p style="font-size: 14px; color: #6e6e73; line-height: 1.6;">
                                        Through the integration of Marketing Team's customer analysis expertise (324% ROI), Finance Team's profitability calculation accuracy (92% reliability), and Sales Team's customer relationship management skills ($3.73K LTV), we achieved a 25% improvement in overall analysis quality and 35% reduction in analysis time.
                                    </p>
                                </div>

                                <!-- Reliability & Trust Indicators -->
                                <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 16px;">
                                        <i class="fas fa-shield-alt" style="margin-right: 8px; color: #10b981;"></i>Reliability & Trust Indicators
                                    </h4>
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 16px;">
                                        <div style="text-align: center; padding: 12px; background: #f0fdf4; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #15803d;">98%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Data Reliability</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: #f0f9ff; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #0369a1;">92%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Model Accuracy</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: #fffbeb; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #ea580c;">96%</div>
                                            <div style="font-size: 11px; color: #6b7280;">Cross-Validation</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Simple Visual Chart -->
                                    <div style="margin-top: 16px;">
                                        <h5 style="font-size: 12px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Team Collaboration Alignment</h5>
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 6px;">
                                            <div style="width: 80px; font-size: 11px; color: #6e6e73;">Marketing-Finance</div>
                                            <div style="flex: 1; background: #e9ecef; border-radius: 4px; height: 8px; position: relative;">
                                                <div style="background: #10b981; border-radius: 4px; height: 8px; width: 98%;"></div>
                                            </div>
                                            <div style="font-size: 11px; font-weight: 600; color: #10b981;">98%</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 6px;">
                                            <div style="width: 80px; font-size: 11px; color: #6e6e73;">Finance-Sales</div>
                                            <div style="flex: 1; background: #e9ecef; border-radius: 4px; height: 8px; position: relative;">
                                                <div style="background: #667eea; border-radius: 4px; height: 8px; width: 96%;"></div>
                                            </div>
                                            <div style="font-size: 11px; font-weight: 600; color: #667eea;">96%</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="width: 80px; font-size: 11px; color: #6e6e73;">Sales-Marketing</div>
                                            <div style="flex: 1; background: #e9ecef; border-radius: 4px; height: 8px; position: relative;">
                                                <div style="background: #f59e0b; border-radius: 4px; height: 8px; width: 94%;"></div>
                                            </div>
                                            <div style="font-size: 11px; font-weight: 600; color: #f59e0b;">94%</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Collaboration Quality Metrics -->
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                    <div>
                                        <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Quality Metrics</h4>
                                        <div style="font-size: 13px; color: #6e6e73; line-height: 1.8;">
                                            • Data consistency score: <strong>98.3%</strong><br>
                                            • Validation success rate: <strong>100%</strong><br>
                                            • Error detection rate: <strong>99.1%</strong>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 12px;">Performance Improvements</h4>
                                        <div style="font-size: 13px; color: #6e6e73; line-height: 1.8;">
                                            • Analysis accuracy: <strong>+25%</strong><br>
                                            • Processing time: <strong>-35%</strong><br>
                                            • Team efficiency: <strong>+42%</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Marketing Team Tab -->
                            <div class="report-tab-content" id="marketing-content" style="padding: 32px; display: none;">
                                <!-- Marketing Team Report Header -->
                                <div style="background: #f0fdf4; border-radius: 12px; padding: 20px; margin-bottom: 24px; border: 1px solid #bbf7d0;">
                                    <div style="font-size: 18px; font-weight: 600; color: #2c2c2c; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-line" style="color: #10b981;"></i>Marketing Team Customer Segmentation Report
                                    </div>
                                    <div style="font-size: 14px; color: #6e6e73; margin-bottom: 16px;">Q2 2024 Customer Analysis & Targeting Optimization</div>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 16px;">
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bbf7d0;">
                                            <div style="font-size: 20px; font-weight: 700; color: #10b981;">324%</div>
                                            <div style="font-size: 12px; color: #6e6e73;">ROI Increase</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bbf7d0;">
                                            <div style="font-size: 20px; font-weight: 700; color: #10b981;">87%</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Targeting Accuracy</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bbf7d0;">
                                            <div style="font-size: 20px; font-weight: 700; color: #10b981;">12</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Segments</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Key Marketing Metrics -->
                                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin-bottom: 24px; border: 1px solid #e5e7eb;">
                                    <h3 style="color: #2c2c2c; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-target" style="color: #10b981;"></i>Key Marketing Performance Indicators
                                    </h3>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Customer Acquisition Cost</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #10b981; margin-bottom: 4px;">$127</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ -32% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Conversion Rate</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #10b981; margin-bottom: 4px;">12.4%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +4.2% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Lead Quality Score</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #10b981; margin-bottom: 4px;">8.7</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +1.3 vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Customer Retention</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #10b981; margin-bottom: 4px;">94%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +7% vs Last Quarter</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Customer Segmentation Analysis -->
                                <div style="background: #ffffff; border-radius: 16px; padding: 28px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 32px;">
                                    <h3 style="color: #2c3e50; font-size: 1.2rem; font-weight: 700; margin-bottom: 20px;">🎯 Customer Segmentation Analysis</h3>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                                        <!-- Segment Performance -->
                                        <div style="background: #f0fdf4; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Top Performing Segments</h4>
                                            <div style="space-y: 12px;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Premium Customers</span>
                                                    <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">$4.2K LTV</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Tech Enthusiasts</span>
                                                    <span style="background: #3b82f6; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">$3.1K LTV</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Young Professionals</span>
                                                    <span style="background: #f59e0b; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">$2.4K LTV</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Budget Conscious</span>
                                                    <span style="background: #ef4444; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">$1.2K LTV</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Campaign Performance -->
                                        <div style="background: #f8faff; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Campaign Performance</h4>
                                            <div style="space-y: 12px;">
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Email Marketing (65%)</span>
                                                        <span style="font-size: 0.9rem; color: #10b981; font-weight: 600;">Excellent</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #10b981; width: 65%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Social Media (52%)</span>
                                                        <span style="font-size: 0.9rem; color: #f59e0b; font-weight: 600;">Good</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #f59e0b; width: 52%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Paid Search (48%)</span>
                                                        <span style="font-size: 0.9rem; color: #3b82f6; font-weight: 600;">Average</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #3b82f6; width: 48%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <h3 style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-chart-line" style="color: #10b981;"></i>Marketing Team Analysis - Customer Analysis Expertise
                                </h3>
                                
                                <div style="background: #ecfdf5; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #059669; margin-bottom: 8px;">📈 Expertise: Customer Segmentation & Targeting Optimization</div>
                                    <div style="font-size: 13px; color: #374151;">Through Marketing Team's customer segmentation expertise, we derived customer targeting strategies with 324% ROI improvement and customer acquisition cost optimization.</div>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #10b981;">324%</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Customer Analysis ROI</div>
                                        <div style="font-size: 11px; color: #8e8e93;">ROI Improvement Analysis</div>
                                    </div>
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #10b981;">87%</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Customer Targeting Accuracy</div>
                                        <div style="font-size: 11px; color: #8e8e93;">Precision Enhancement</div>
                                    </div>
                                </div>
                                
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 16px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Key Contributions</h4>
                                    <div style="font-size: 13px; color: #6e6e73;">Customer segmentation model development, targeting strategy optimization, campaign performance analysis, customer lifetime value prediction</div>
                                </div>
                            </div>

                            <!-- Finance Team Tab -->
                            <div class="report-tab-content" id="finance-content" style="padding: 32px; display: none;">
                                <!-- Finance Team Report Header -->
                                <div style="background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 24px; border: 1px solid #e9ecef;">
                                    <div style="font-size: 18px; font-weight: 600; color: #2c2c2c; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-dollar-sign" style="color: #f59e0b;"></i>Finance Team Profitability Analysis Report
                                    </div>
                                    <div style="font-size: 14px; color: #6e6e73; margin-bottom: 16px;">Q2 2024 Revenue Modeling & Financial Risk Assessment</div>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 16px;">
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 20px; font-weight: 700; color: #f59e0b;">$215M</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Revenue Forecast</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 20px; font-weight: 700; color: #f59e0b;">92%</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Reliability</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #e9ecef;">
                                            <div style="font-size: 20px; font-weight: 700; color: #f59e0b;">15</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Analysis Channels</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Key Financial Metrics -->
                                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin-bottom: 24px; border: 1px solid #e5e7eb;">
                                    <h3 style="color: #2c2c2c; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-bar" style="color: #f59e0b;"></i>Key Financial Performance Indicators
                                    </h3>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Marketing ROI</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b; margin-bottom: 4px;">324%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +47% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Net Profit Margin</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b; margin-bottom: 4px;">18.7%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +2.3% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Cost Efficiency</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b; margin-bottom: 4px;">89%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +12% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Cash Flow</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b; margin-bottom: 4px;">$45M</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +28% vs Last Quarter</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Profitability Analysis Chart -->
                                <div style="background: #ffffff; border-radius: 16px; padding: 28px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 32px;">
                                    <h3 style="color: #2c3e50; font-size: 1.2rem; font-weight: 700; margin-bottom: 20px;">📈 Channel Profitability Analysis</h3>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                                        <!-- Channel ROI Comparison -->
                                        <div style="background: #f8faff; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Channel ROI Comparison</h4>
                                            <div style="space-y: 12px;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Digital Marketing</span>
                                                    <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">425%</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Email Marketing</span>
                                                    <span style="background: #3b82f6; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">387%</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Social Media</span>
                                                    <span style="background: #f59e0b; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">298%</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Traditional Media</span>
                                                    <span style="background: #ef4444; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">187%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Cost Structure Analysis -->
                                        <div style="background: #f0f9f0; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Cost Structure Optimization</h4>
                                            <div style="space-y: 12px;">
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Personnel Costs (45%)</span>
                                                        <span style="font-size: 0.9rem; color: #10b981; font-weight: 600;">Optimized</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #10b981; width: 45%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Marketing Costs (32%)</span>
                                                        <span style="font-size: 0.9rem; color: #f59e0b; font-weight: 600;">Needs Adjustment</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #f59e0b; width: 32%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Operating Costs (23%)</span>
                                                        <span style="font-size: 0.9rem; color: #10b981; font-weight: 600;">Efficient</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #10b981; width: 23%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <h3 style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-dollar-sign" style="color: #f59e0b;"></i>Finance Team Analysis - Profitability Analysis Expertise
                                </h3>
                                
                                <div style="background: #fffbeb; border: 1px solid #fed7aa; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #ea580c; margin-bottom: 8px;">💰 Expertise: Revenue Modeling & Financial Risk Assessment</div>
                                    <div style="font-size: 13px; color: #374151;">Through Finance Team's revenue modeling expertise, we derived profitability optimization strategies with $215M revenue projection and 92% reliability validation.</div>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #f59e0b;">$215M</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Expected Revenue</div>
                                        <div style="font-size: 11px; color: #8e8e93;">Annual Projection</div>
                                    </div>
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #f59e0b;">92%</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Model Reliability</div>
                                        <div style="font-size: 11px; color: #8e8e93;">Accuracy Validation</div>
                                    </div>
                                </div>
                                
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 16px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Key Contributions</h4>
                                    <div style="font-size: 13px; color: #6e6e73;">Revenue forecasting model, cost-benefit analysis, financial risk assessment, profitability optimization strategies</div>
                                </div>
                            </div>

                            <!-- Sales Team Tab -->
                            <div class="report-tab-content" id="sales-content" style="padding: 32px; display: none;">
                                <!-- Sales Team Report Header -->
                                <div style="background: #f0f9ff; border-radius: 12px; padding: 20px; margin-bottom: 24px; border: 1px solid #bae6fd;">
                                    <div style="font-size: 18px; font-weight: 600; color: #2c2c2c; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-users" style="color: #667eea;"></i>Sales Team Customer Relationship Report
                                    </div>
                                    <div style="font-size: 14px; color: #6e6e73; margin-bottom: 16px;">Q2 2024 CRM Performance & Sales Process Optimization</div>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 16px;">
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bae6fd;">
                                            <div style="font-size: 20px; font-weight: 700; color: #667eea;">$3.73K</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Avg LTV</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bae6fd;">
                                            <div style="font-size: 20px; font-weight: 700; color: #667eea;">92%</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Conversion Rate</div>
                                        </div>
                                        <div style="text-align: center; padding: 12px; background: white; border-radius: 6px; border: 1px solid #bae6fd;">
                                            <div style="font-size: 20px; font-weight: 700; color: #667eea;">847</div>
                                            <div style="font-size: 12px; color: #6e6e73;">Qualified Leads</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Key Sales Metrics -->
                                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin-bottom: 24px; border: 1px solid #e5e7eb;">
                                    <h3 style="color: #2c2c2c; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-line" style="color: #667eea;"></i>Key Sales Performance Indicators
                                    </h3>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sales Cycle Length</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">23 days</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ -8 days vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Deal Size Average</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">$127K</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +18% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Win Rate</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">67%</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +12% vs Last Quarter</div>
                                        </div>
                                        <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px; text-align: center;">
                                            <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Pipeline Value</div>
                                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">$8.4M</div>
                                            <div style="font-size: 11px; color: #28a745;">↗ +24% vs Last Quarter</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sales Pipeline Analysis -->
                                <div style="background: #ffffff; border-radius: 16px; padding: 28px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 32px;">
                                    <h3 style="color: #2c3e50; font-size: 1.2rem; font-weight: 700; margin-bottom: 20px;">📊 Sales Pipeline Analysis</h3>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                                        <!-- Pipeline Stages -->
                                        <div style="background: #f0f9ff; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Pipeline Stage Performance</h4>
                                            <div style="space-y: 12px;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Qualified Leads</span>
                                                    <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">847</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Proposals Sent</span>
                                                    <span style="background: #3b82f6; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">234</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; margin-bottom: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Negotiations</span>
                                                    <span style="background: #f59e0b; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">87</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px;">
                                                    <span style="font-weight: 600; color: #374151;">Closed Won</span>
                                                    <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 6px; font-size: 0.9rem; font-weight: 600;">156</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Territory Performance -->
                                        <div style="background: #f8faff; border-radius: 12px; padding: 24px;">
                                            <h4 style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;">Territory Performance</h4>
                                            <div style="space-y: 12px;">
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">North America (42%)</span>
                                                        <span style="font-size: 0.9rem; color: #10b981; font-weight: 600;">$3.5M</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #10b981; width: 42%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Europe (31%)</span>
                                                        <span style="font-size: 0.9rem; color: #3b82f6; font-weight: 600;">$2.6M</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #3b82f6; width: 31%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 16px;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                        <span style="font-size: 0.9rem; color: #666;">Asia Pacific (27%)</span>
                                                        <span style="font-size: 0.9rem; color: #f59e0b; font-weight: 600;">$2.3M</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 4px; height: 8px;">
                                                        <div style="background: #f59e0b; width: 27%; height: 8px; border-radius: 4px;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <h3 style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-users" style="color: #667eea;"></i>Sales Team Analysis - Customer Relationship Management Expertise
                                </h3>
                                
                                <div style="background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #0369a1; margin-bottom: 8px;">🎯 Expertise: Customer Lifetime Value & Conversion Optimization</div>
                                    <div style="font-size: 13px; color: #374151;">Through Sales Team's integrated management expertise, we derived conversion rate improvement strategies through customer LTV analysis and sales process optimization.</div>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #667eea;">$3.73K</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Average Customer LTV</div>
                                        <div style="font-size: 11px; color: #8e8e93;">Lifetime Value Analysis</div>
                                    </div>
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 16px;">
                                        <div style="font-size: 24px; font-weight: 700; color: #667eea;">92%</div>
                                        <div style="font-size: 12px; color: #6e6e73;">Lead Conversion Rate</div>
                                        <div style="font-size: 11px; color: #8e8e93;">Conversion Optimization</div>
                                    </div>
                                </div>
                                
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 16px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px;">Key Contributions</h4>
                                    <div style="font-size: 13px; color: #6e6e73;">Customer relationship analysis, sales funnel optimization, lead scoring model, conversion rate improvement strategies</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Analysis View -->
            <div class="content-view" id="agent-analysis-view">
                <div class="content-header">
                    <h1 class="page-title">AI Agent Analysis</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary">
                            <i class="fas fa-download"></i>
                            Export Results
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-play"></i>
                            Start Analysis
                        </button>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="content-body">
                    <div style="display: grid; grid-template-columns: 280px 1fr 320px; height: calc(100vh - 140px); gap: 0;">
                        <!-- Left: Team Context -->
                        <div class="sidebar-panel" style="background: #f8f9fa; border-right: 1px solid #e5e7eb; padding: 20px; overflow-y: auto;" id="teamContext">
                            <div class="panel-header">
                                <i class="fas fa-database" style="color: #667eea; margin-right: 8px;"></i>
                                Available Datasets
                            </div>
                        
                            <div class="dataset-group" style="margin-bottom: 24px;">
                                <div class="dataset-group-title">
                                    <i class="fas fa-users" style="color: #6b7280; margin-right: 8px;"></i>
                                    Team Datasets
                                </div>
                                <div class="team-dataset" onclick="selectTeam('marketing')" style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.3s ease;">
                                    <div class="team-name">
                                        <i class="fas fa-chart-line" style="color: #667eea; margin-right: 8px;"></i>
                                        Marketing Team
                                    </div>
                                    <div class="dataset-description">Customer segment analysis data</div>
                                    <div class="dataset-fields">Customer ID, Age Group, Purchase History, Churn Rate</div>
                                </div>
                            </div>

                            <div class="dataset-group" style="margin-bottom: 24px;">
                                <div class="dataset-group-title">
                                    <i class="fas fa-share-alt" style="color: #6b7280; margin-right: 8px;"></i>
                                    Shared Datasets
                                </div>
                                <div class="team-dataset" onclick="selectTeam('finance')" style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.3s ease;">
                                    <div class="team-name">
                                        <i class="fas fa-dollar-sign" style="color: #10b981; margin-right: 8px;"></i>
                                        Finance Team
                                    </div>
                                    <div class="dataset-description">Marketing ROI analysis data</div>
                                    <div class="dataset-fields">Campaign ID, Cost, Revenue, ROI</div>
                                </div>

                                <div class="team-dataset" onclick="selectTeam('sales')" style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.3s ease;">
                                    <div class="team-name">
                                        <i class="fas fa-handshake" style="color: #f59e0b; margin-right: 8px;"></i>
                                        Sales Team
                                    </div>
                                    <div class="dataset-description">Customer LTV prediction data</div>
                                    <div class="dataset-fields">Customer ID, Contact History, Contract Amount, LTV</div>
                                </div>
                            </div>
                        </div>

                        <!-- Center: Analysis Area -->
                        <div class="main-panel" style="background: white; padding: 32px; overflow-y: auto; display: flex; flex-direction: column;">
                            <!-- Analysis Header -->
                            <div class="analysis-header" style="margin-bottom: 32px; padding-bottom: 20px; border-bottom: 1px solid #e5e7eb;">
                                <div id="selectedTeamTitle" class="analysis-title">Please select a team to analyze</div>
                                <div id="analysisRequest" class="analysis-description">
                                    Select a team dataset from the left panel to display that team's requirements.
                                </div>
                            </div>

                            <!-- Auto Data Review Section -->
                            <div id="autoReviewSection" class="review-section" style="display: none; margin-bottom: 32px;">
                                <div class="review-header" style="margin-bottom: 24px;">
                                    <div class="section-title">
                                        <i class="fas fa-search" style="color: #667eea; margin-right: 8px;"></i>
                                        Automated dataset review in progress...
                                    </div>
                                <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                                    <div style="width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin-bottom: 8px;">
                                        <div id="reviewProgressFill" style="height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 4px; transition: width 0.5s ease; width: 0%;"></div>
                                    </div>
                                    <div id="reviewProgressText" style="font-size: 14px; color: #666; text-align: center;">Analyzing data received from Step 4...</div>
                                </div>
                            </div>
                            <div id="reviewInsights" style="display: grid; gap: 12px; margin-bottom: 20px;"></div>
                        </div>

                            <!-- Recommended Modules Section -->
                            <div id="recommendedModules" class="modules-section" style="display: none; margin-bottom: 32px;">
                                <div class="section-title">
                                    <i class="fas fa-bullseye" style="color: #667eea; margin-right: 8px;"></i>
                                    Data-driven Recommended Analysis Modules
                                </div>
                            <div id="modulesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 20px;"></div>
                            <div style="background: #f8f9fa; border: 2px dashed #dee2e6; border-radius: 12px; padding: 20px; text-align: center; margin-top: 12px;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 12px;">Don't see the analysis you want?</div>
                                <input type="text" id="customAnalysisInput" placeholder="e.g. Customer lifetime value prediction, segment-specific campaign effectiveness analysis..." style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 8px; font-size: 14px; margin-bottom: 12px;">
                                <button onclick="submitCustomRequest()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 14px; cursor: pointer; transition: all 0.3s ease;">Request Custom Analysis</button>
                            </div>
                        </div>

                        <!-- Execution Section -->
                        <div id="executeSection" style="display: none; text-align: center; margin-top: 32px;">
                            <button id="executeButton" onclick="startAnalysis()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 18px 36px; border-radius: 12px; font-size: 17px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                                Start analysis with selected module
                            </button>
                        </div>

                            <!-- Analysis Progress -->
                            <div id="analysisProgress" class="progress-section" style="display: none; text-align: center; padding: 40px 20px;">
                                <div class="progress-header" style="margin-bottom: 32px;">
                                    <div class="progress-icon" style="font-size: 48px; margin-bottom: 16px; color: #667eea;">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <div class="progress-title">Marketing Agent Analysis in Progress</div>
                                </div>
                            <div style="width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin-bottom: 8px;">
                                <div id="progressFill" style="height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 4px; transition: width 0.5s ease; width: 0%;"></div>
                            </div>
                            <div id="progressContent" style="font-size: 16px; color: #495057; font-weight: 500;">Sense stage: Recognizing data patterns...</div>
                        </div>

                        <!-- Analysis Results -->
                        <div id="resultsSection" style="flex: 1; display: none;">
                            <!-- Results Tab Navigation -->
                            <div id="resultsTabs" style="display: none; margin-bottom: 24px;">
                                <div style="display: flex; background: #f8f9fa; border-radius: 8px; padding: 4px; gap: 4px;">
                                    <button class="tab-btn active" onclick="showTab('segment')" style="flex: 1; background: white; border: none; padding: 12px 16px; border-radius: 6px; font-size: 14px; font-weight: 600; color: #667eea; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">🎯 Segment Analysis</button>
                                    <button class="tab-btn" onclick="showTab('expansion')" style="flex: 1; background: transparent; border: none; padding: 12px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; color: #666; cursor: pointer; transition: all 0.3s ease;">💫 Population Expansion</button>
                                    <button class="tab-btn" onclick="showTab('targeting')" style="flex: 1; background: transparent; border: none; padding: 12px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; color: #666; cursor: pointer; transition: all 0.3s ease;">🎯 Target Extraction</button>
                                </div>
                            </div>
                            
                            <!-- Segment Analysis Tab -->
                            <div class="tab-content segment-tab" id="segmentTab" style="display: block;">
                                <div style="margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #e5e7eb;">
                                    <div style="font-size: 18px; font-weight: 600; color: #171719; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-pie" style="color: #667eea;"></i>Segment Analysis Results
                                    </div>
                                </div>
                                <div class="segment-cards" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 24px;">
                                    <div class="segment-card high-value show" style="border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: all 0.3s ease; opacity: 1; transform: translateY(0); border: 2px solid #667eea; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #e9ecef;">
                                            <div style="font-size: 24px;">💎</div>
                                            <div style="font-size: 16px; font-weight: 600; color: #2c2c2c; flex: 1;">High-Value Customers</div>
                                            <div style="font-size: 18px; font-weight: 700; color: #667eea; background: rgba(102, 126, 234, 0.1); padding: 4px 12px; border-radius: 16px;">230 customers (23%)</div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Average Purchase Amount</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">$221</span>
                                            </div>
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Repurchase Rate</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">84%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="segment-card growth-potential show" style="border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: all 0.3s ease; opacity: 1; transform: translateY(0); border: 2px solid #28a745; background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(32, 201, 151, 0.1) 100%);">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #e9ecef;">
                                            <div style="font-size: 24px;">🚀</div>
                                            <div style="font-size: 16px; font-weight: 600; color: #2c2c2c; flex: 1;">Growth Potential Customers</div>
                                            <div style="font-size: 18px; font-weight: 700; color: #667eea; background: rgba(102, 126, 234, 0.1); padding: 4px 12px; border-radius: 16px;">410 customers (41%)</div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Avg Purchase</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">$120</span>
                                            </div>
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Repurchase Rate</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">67%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="segment-card price-sensitive show" style="border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: all 0.3s ease; opacity: 1; transform: translateY(0); border: 2px solid #ff9500; background: linear-gradient(135deg, rgba(255, 149, 0, 0.1) 0%, rgba(255, 107, 53, 0.1) 100%);">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #e9ecef;">
                                            <div style="font-size: 24px;">💰</div>
                                            <div style="font-size: 16px; font-weight: 600; color: #2c2c2c; flex: 1;">Price-Sensitive Customers</div>
                                            <div style="font-size: 18px; font-weight: 700; color: #667eea; background: rgba(102, 126, 234, 0.1); padding: 4px 12px; border-radius: 16px;">360 customers (36%)</div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Avg Purchase</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">$68</span>
                                            </div>
                                            <div style="text-align: center;">
                                                <span style="display: block; font-size: 12px; color: #666; margin-bottom: 4px;">Repurchase Rate</span>
                                                <span style="display: block; font-size: 16px; font-weight: 600; color: #2c2c2c;">42%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Population Expansion Tab -->
                            <div class="tab-content expansion-tab" id="expansionTab" style="display: none;">
                                <div style="margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #e5e7eb;">
                                    <div style="font-size: 18px; font-weight: 600; color: #171719; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-expand-arrows-alt" style="color: #667eea;"></i>Population Expansion Analysis
                                    </div>
                                </div>
                                
                                <!-- Expansion Strategy -->
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-chart-area" style="color: #10b981;"></i>Market Expansion Opportunities
                                    </h4>
                                    <p style="font-size: 14px; color: #6b7280; line-height: 1.6; margin-bottom: 16px;">
                                        Based on current customer segments, we identified 3 key expansion opportunities that could increase total addressable market by 147%.
                                    </p>
                                    
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px;">
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                                <i class="fas fa-user-graduate" style="color: #667eea;"></i>
                                                <span style="font-size: 14px; font-weight: 600; color: #171719;">Young Professionals (25-35)</span>
                                            </div>
                                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Expected new customers: 2,340</div>
                                            <div style="font-size: 12px; color: #6b7280;">Avg LTV potential: $2,180</div>
                                        </div>
                                        
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px;">
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                                <i class="fas fa-home" style="color: #10b981;"></i>
                                                <span style="font-size: 14px; font-weight: 600; color: #171719;">Suburban Families</span>
                                            </div>
                                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Expected new customers: 1,890</div>
                                            <div style="font-size: 12px; color: #6b7280;">Avg LTV potential: $3,450</div>
                                        </div>
                                        
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px;">
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                                <i class="fas fa-laptop" style="color: #f59e0b;"></i>
                                                <span style="font-size: 14px; font-weight: 600; color: #171719;">Remote Workers</span>
                                            </div>
                                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Expected new customers: 1,560</div>
                                            <div style="font-size: 12px; color: #6b7280;">Avg LTV potential: $2,890</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Implementation Timeline -->
                                <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-calendar-alt" style="color: #667eea;"></i>Expansion Implementation Timeline
                                    </h4>
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                                        <div style="text-align: center; padding: 16px; background: #f0f9ff; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #0369a1;">Q1 2026</div>
                                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Young Professionals</div>
                                        </div>
                                        <div style="text-align: center; padding: 16px; background: #f0fdf4; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #15803d;">Q2 2026</div>
                                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Suburban Families</div>
                                        </div>
                                        <div style="text-align: center; padding: 16px; background: #fffbeb; border-radius: 6px;">
                                            <div style="font-size: 20px; font-weight: 700; color: #ea580c;">Q3 2026</div>
                                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Remote Workers</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Target Extraction Tab -->
                            <div class="tab-content targeting-tab" id="targetingTab" style="display: none;">
                                <div style="margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #e5e7eb;">
                                    <div style="font-size: 18px; font-weight: 600; color: #171719; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-crosshairs" style="color: #667eea;"></i>Target Extraction Results
                                    </div>
                                </div>
                                
                                <!-- High-Priority Targets -->
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-star" style="color: #f59e0b;"></i>High-Priority Target Profiles
                                    </h4>
                                    <p style="font-size: 14px; color: #6b7280; line-height: 1.6; margin-bottom: 16px;">
                                        AI-identified customer profiles with highest conversion probability and lifetime value potential.
                                    </p>
                                    
                                    <div style="display: grid; gap: 16px;">
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; display: flex; align-items: center; gap: 16px;">
                                            <div style="background: #dc2626; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">A</div>
                                            <div style="flex: 1;">
                                                <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 4px;">Premium Switchers</div>
                                                <div style="font-size: 12px; color: #6b7280;">High-income customers dissatisfied with current premium services</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 16px; font-weight: 700; color: #dc2626;">89%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Conversion Rate</div>
                                            </div>
                                        </div>
                                        
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; display: flex; align-items: center; gap: 16px;">
                                            <div style="background: #f59e0b; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">B</div>
                                            <div style="flex: 1;">
                                                <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 4px;">Growth-Stage Startups</div>
                                                <div style="font-size: 12px; color: #6b7280;">Fast-growing companies with expanding team needs</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 16px; font-weight: 700; color: #f59e0b;">76%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Conversion Rate</div>
                                            </div>
                                        </div>
                                        
                                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; display: flex; align-items: center; gap: 16px;">
                                            <div style="background: #10b981; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">C</div>
                                            <div style="flex: 1;">
                                                <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 4px;">Budget-Conscious SMBs</div>
                                                <div style="font-size: 12px; color: #6b7280;">Cost-sensitive small businesses seeking value-driven solutions</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 16px; font-weight: 700; color: #10b981;">63%</div>
                                                <div style="font-size: 10px; color: #6b7280;">Conversion Rate</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Targeting Strategy -->
                                <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                                    <h4 style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-bullseye" style="color: #667eea;"></i>Recommended Targeting Strategy
                                    </h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                                        <div style="text-align: center; padding: 16px; background: #fef2f2; border-radius: 6px; border: 1px solid #fecaca;">
                                            <div style="font-size: 24px; font-weight: 700; color: #dc2626;">$847K</div>
                                            <div style="font-size: 12px; color: #6b7280;">Expected Revenue (A-Tier)</div>
                                        </div>
                                        <div style="text-align: center; padding: 16px; background: #fffbeb; border-radius: 6px; border: 1px solid #fed7aa;">
                                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b;">$634K</div>
                                            <div style="font-size: 12px; color: #6b7280;">Expected Revenue (B-Tier)</div>
                                        </div>
                                        <div style="text-align: center; padding: 16px; background: #f0fdf4; border-radius: 6px; border: 1px solid #bbf7d0;">
                                            <div style="font-size: 24px; font-weight: 700; color: #10b981;">$423K</div>
                                            <div style="font-size: 12px; color: #6b7280;">Expected Revenue (C-Tier)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Original Analysis Results -->
                            <div style="margin-bottom: 32px;">
                                <div style="font-size: 18px; font-weight: 600; color: #2c2c2c; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">📋 Analysis Results (Total 4)</div>
                                <div style="display: grid; gap: 20px;">
                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                                        <div style="font-size: 14px; color: #495057; line-height: 1.6; margin-bottom: 16px;">
                                            <strong>Key Finding:</strong> Strong correlation confirmed with mobile app usage frequency. Major churn point is within 3 months after first purchase (67%), indicating urgent need for onboarding process improvement. App push notification acceptance rate is particularly low (18%) with 2.3x higher churn rate in that customer group.
                                        </div>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                            <div class="add-team-btn" onclick="showTeamDropdown(this)" style="background: #f8f9fa; color: #667eea; border: 1px dashed #667eea; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; position: relative;">
                                                + Add Collaboration Team
                                                <div class="team-dropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 2px solid #667eea; border-radius: 8px; padding: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); z-index: 9999; min-width: 200px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Dev Team', 'App push notification system improvement')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Dev Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Product Team', 'Onboarding process improvement')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Product Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Finance Team', 'Budget review')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Finance Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Sales Team', 'Expand customer touchpoints')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Sales Team</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="collab-comment-section" id="commentSection1" style="margin-top: 16px; padding: 16px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: none;">
                                            <div style="font-size: 12px; font-weight: 600; color: #495057; margin-bottom: 8px;">Collaboration Request (Will be delivered to Step 4 team)</div>
                                            <textarea style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; resize: vertical; min-height: 80px; font-family: inherit; background: white;" placeholder="Please enter specific collaboration requirements..."></textarea>
                                        </div>
                                    </div>

                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                                        <div style="font-size: 14px; color: #495057; line-height: 1.6; margin-bottom: 16px;">
                                            <strong>Additional Finding:</strong> Seasonal purchasing patterns have greater impact on churn rate than expected. Winter (Dec-Feb) churn rate increases by 37%, suggesting need for product portfolio expansion. Winter-related product reinforcement is urgent, with 43% shortage in winter product lineup compared to competitors.
                                        </div>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                            <div class="add-team-btn" onclick="showTeamDropdown(this)" style="background: #f8f9fa; color: #667eea; border: 1px dashed #667eea; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; position: relative;">
                                                + Add Collaboration Team
                                                <div class="team-dropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 2px solid #667eea; border-radius: 8px; padding: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); z-index: 9999; min-width: 200px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Product Team', 'Winter product lineup expansion')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Product Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Finance Team', 'Product expansion budget')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Finance Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Sales Team', 'Seasonal sales strategy')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Sales Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Dev Team', 'System improvement')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Dev Team</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="collab-comment-section" id="commentSection2" style="margin-top: 16px; padding: 16px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: none;">
                                            <div style="font-size: 12px; font-weight: 600; color: #495057; margin-bottom: 8px;">Collaboration Request (Will be delivered to Step 4 team)</div>
                                            <textarea style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; resize: vertical; min-height: 80px; font-family: inherit; background: white;" placeholder="Please enter specific collaboration requirements..."></textarea>
                                        </div>
                                    </div>

                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                                        <div style="font-size: 14px; color: #495057; line-height: 1.6; margin-bottom: 16px;">
                                            <strong>Strategic Proposal:</strong> Personalized push notification system implementation expected to reduce churn rate by 35%. Implementation budget estimated at 30M KRW, ROI recoverable within 6 months. Gradual application through A/B testing recommended, starting with high-risk group of 1,200 customers. Expected revenue increase effect is around 24M KRW per month.
                                        </div>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                            <div class="add-team-btn" onclick="showTeamDropdown(this)" style="background: #f8f9fa; color: #667eea; border: 1px dashed #667eea; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; position: relative;">
                                                + Add Collaboration Team
                                                <div class="team-dropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 2px solid #667eea; border-radius: 8px; padding: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); z-index: 9999; min-width: 200px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Finance Team', 'ROI verification and budget approval')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Finance Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Dev Team', 'Push system implementation')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Dev Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Product Team', 'A/B test design')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Product Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Sales Team', 'High-risk customer management')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Sales Team</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="collab-comment-section" id="commentSection3" style="margin-top: 16px; padding: 16px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: none;">
                                            <div style="font-size: 12px; font-weight: 600; color: #495057; margin-bottom: 8px;">Collaboration Request (Will be delivered to Step 4 team)</div>
                                            <textarea style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; resize: vertical; min-height: 80px; font-family: inherit; background: white;" placeholder="Please enter specific collaboration requirements..."></textarea>
                                        </div>
                                    </div>

                                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                                        <div style="font-size: 14px; color: #495057; line-height: 1.6; margin-bottom: 16px;">
                                            <strong>Segment Analysis:</strong> Premium customers (top 20%) have 4.2x higher LTV than regular customers. Their characteristics are 3+ monthly purchases, 85% review writing rate, 92% referral program participation. Significant revenue increase effect expected through focused management, with 15% additional customer satisfaction improvement possible when operating dedicated CS team.
                                        </div>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                            <div class="add-team-btn" onclick="showTeamDropdown(this)" style="background: #f8f9fa; color: #667eea; border: 1px dashed #667eea; padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; position: relative;">
                                                + Add Collaboration Team
                                                <div class="team-dropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 2px solid #667eea; border-radius: 8px; padding: 8px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); z-index: 9999; min-width: 200px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Sales Team', 'VIP customer dedicated management')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Sales Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Product Team', 'Premium service planning')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Product Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'Finance Team', 'VIP program investment review')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">Finance Team</div>
                                                    <div class="dropdown-item" onclick="addCollaboration(this, 'CS Team', 'Dedicated CS team setup')" style="padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.2s ease; white-space: nowrap;">CS Team</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="collab-comment-section" id="commentSection4" style="margin-top: 16px; padding: 16px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: none;">
                                            <div style="font-size: 12px; font-weight: 600; color: #495057; margin-bottom: 8px;">Collaboration Request (Will be delivered to Step 4 team)</div>
                                            <textarea style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; resize: vertical; min-height: 80px; font-family: inherit; background: white;" placeholder="Please enter specific collaboration requirements..."></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                            <!-- Empty State -->
                            <div id="emptyState" class="empty-state" style="text-align: center; padding: 60px 20px; color: #9ca3af; display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1;">
                                <div class="empty-state-icon" style="font-size: 48px; margin-bottom: 16px; color: #d1d5db;">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="empty-state-text">Please select analysis type and click execute button</div>
                            </div>
                    </div>

                        <!-- Right: SPAR + Collaboration Tools -->
                        <div class="sidebar-panel" style="background: #f8f9fa; border-left: 1px solid #e5e7eb; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 24px;" id="sparSection">
                            <!-- SPAR Status -->
                            <div class="spar-panel">
                                <div class="panel-header">
                                    <i class="fas fa-brain" style="color: #667eea; margin-right: 8px;"></i>
                                    Agent Thinking Process
                                </div>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div class="spar-step completed" id="senseStep" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; transition: all 0.3s ease; position: relative; background: #e7f5e7;">
                                    <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: white; background: #ff6b6b;">S</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 14px; font-weight: 600; color: #2c2c2c; margin-bottom: 4px;">Sense</div>
                                        <div style="font-size: 12px; color: #666;">Data pattern recognition complete</div>
                                    </div>
                                    <div id="senseTooltip" style="position: absolute; top: 50%; left: -250px; transform: translateY(-50%); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); z-index: 9999; opacity: 1; visibility: visible; backdrop-filter: blur(10px); max-width: 220px; text-align: center; border: 2px solid rgba(255, 255, 255, 0.2);">
                                        Select a team to analyze on the left and start agent analysis!
                                        <div style="content: ''; position: absolute; right: -12px; top: 50%; transform: translateY(-50%); width: 0; height: 0; border-style: solid; border-width: 12px 0 12px 12px; border-color: transparent transparent transparent #667eea;"></div>
                                    </div>
                                </div>
                                
                                <div class="spar-step" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; transition: all 0.3s ease; position: relative;">
                                    <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: white; background: #4ecdc4;">P</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 14px; font-weight: 600; color: #2c2c2c; margin-bottom: 4px;">Plan</div>
                                        <div style="font-size: 12px; color: #666;">Waiting for analysis strategy setup</div>
                                    </div>
                                </div>
                                
                                <div class="spar-step" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; transition: all 0.3s ease; position: relative;">
                                    <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: white; background: #45b7d1;">A</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 14px; font-weight: 600; color: #2c2c2c; margin-bottom: 4px;">Act</div>
                                        <div style="font-size: 12px; color: #666;">Waiting for analysis execution</div>
                                    </div>
                                </div>
                                
                                <div class="spar-step" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; transition: all 0.3s ease; position: relative;">
                                    <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: white; background: #96ceb4;">R</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 14px; font-weight: 600; color: #2c2c2c; margin-bottom: 4px;">Reflect</div>
                                        <div style="font-size: 12px; color: #666;">Waiting for result verification</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                            <!-- Collaboration Cart -->
                            <div class="collaboration-panel" style="background: white; border-radius: 8px; padding: 20px; border: 1px solid #e5e7eb; flex: 1;">
                                <div class="panel-header">
                                    <i class="fas fa-shopping-cart" style="color: #667eea; margin-right: 8px;"></i>
                                    Collaboration Request Cart
                                </div>
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 16px; min-height: 120px; display: flex; flex-direction: column;">
                                <div style="font-size: 14px; font-weight: 600; color: #495057; margin-bottom: 12px;">Selected Collaboration Requests</div>
                                <div id="cartItems" style="flex: 1; margin-bottom: 12px;">
                                    <div style="text-align: center; color: #8e8e93; font-size: 14px; padding: 20px;">No collaboration requests selected yet</div>
                                </div>
                                <button id="sendCollabBtn" disabled onclick="sendCollaborationRequests()" style="background: #dee2e6; color: #adb5bd; border: none; padding: 12px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: not-allowed; transition: all 0.3s ease;">
                                    Send Collaboration Request
                                </button>
                                <div id="successMessage" style="background: #d4edda; color: #155724; padding: 12px; border-radius: 6px; font-size: 14px; text-align: center; margin-top: 12px; display: none;">
                                    Collaboration request sent to Step 4 workspace!
                                </div>
                            </div>

                            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-size: 12px; color: #6b7280;">Collaboration Request Pending</span>
                                    <span id="collaborateCount" style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            <!-- History View -->
            <div class="content-view" id="history-view">
                <div class="content-header">
                    <h1 class="page-title">Analysis History</h1>
                    <div class="header-actions">
                        <input type="text" class="search-input" placeholder="Search history...">
                    </div>
                </div>
                <div class="content-body" style="padding: 32px;">
                    <!-- Recent Analysis History -->
                    <div style="background: white; border-radius: 12px; border: 1px solid #e5e7eb; overflow: hidden;">
                        <div style="background: #f8f9fa; padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                            <h2 style="font-size: 18px; font-weight: 600; color: #1d1d1f; margin: 0;">Recent Analysis History</h2>
                            <p style="font-size: 13px; color: #6e6e73; margin: 8px 0 0 0;">Latest 5 completed analyses</p>
                        </div>
                        
                        <div style="padding: 0;">
                            <!-- History Item 1 -->
                            <div style="padding: 20px 24px; border-bottom: 1px solid #f3f4f6; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-chart-line" style="color: white; font-size: 16px;"></i>
                                        </div>
                                        <div>
                                            <h3 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin: 0;">Q3 Customer Segmentation Analysis</h3>
                                            <div style="font-size: 13px; color: #6e6e73; margin-top: 4px;">Marketing Team • RFM Analysis • 95% Confidence</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #8e8e93;">Generated 324% ROI improvement insights</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sep 18, 2025</div>
                                    <div style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Completed</div>
                                </div>
                            </div>
                            
                            <!-- History Item 2 -->
                            <div style="padding: 20px 24px; border-bottom: 1px solid #f3f4f6; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #f59e0b, #ea580c); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-dollar-sign" style="color: white; font-size: 16px;"></i>
                                        </div>
                                        <div>
                                            <h3 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin: 0;">Marketing ROI Optimization</h3>
                                            <div style="font-size: 13px; color: #6e6e73; margin-top: 4px;">Finance Team • Budget Analysis • 96% Confidence</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #8e8e93;">Identified $2.1M budget reallocation opportunity</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sep 17, 2025</div>
                                    <div style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Completed</div>
                                </div>
                            </div>
                            
                            <!-- History Item 3 -->
                            <div style="padding: 20px 24px; border-bottom: 1px solid #f3f4f6; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-users" style="color: white; font-size: 16px;"></i>
                                        </div>
                                        <div>
                                            <h3 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin: 0;">Sales Pipeline Prediction</h3>
                                            <div style="font-size: 13px; color: #6e6e73; margin-top: 4px;">Sales Team • LTV Model • 89% Confidence</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #8e8e93;">Predicted Q4 sales performance with 92% accuracy</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sep 16, 2025</div>
                                    <div style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Completed</div>
                                </div>
                            </div>
                            
                            <!-- History Item 4 -->
                            <div style="padding: 20px 24px; border-bottom: 1px solid #f3f4f6; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-handshake" style="color: white; font-size: 16px;"></i>
                                        </div>
                                        <div>
                                            <h3 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin: 0;">Integrated Customer Journey</h3>
                                            <div style="font-size: 13px; color: #6e6e73; margin-top: 4px;">Marketing+Sales • Cross-team • 97% Confidence</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #8e8e93;">Mapped complete customer touchpoint optimization</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sep 15, 2025</div>
                                    <div style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Completed</div>
                                </div>
                            </div>
                            
                            <!-- History Item 5 -->
                            <div style="padding: 20px 24px; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-chart-bar" style="color: white; font-size: 16px;"></i>
                                        </div>
                                        <div>
                                            <h3 style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin: 0;">Brand Campaign Effect Analysis</h3>
                                            <div style="font-size: 13px; color: #6e6e73; margin-top: 4px;">Marketing Team • Campaign Analysis • 91% Confidence</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #8e8e93;">Measured 30-day brand awareness campaign impact</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">Sep 14, 2025</div>
                                    <div style="background: #10b981; color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;">Completed</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Summary Stats -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 24px;">
                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #10b981; margin-bottom: 8px;">47</div>
                            <div style="font-size: 14px; color: #6e6e73;">Total Analyses</div>
                        </div>
                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 8px;">94%</div>
                            <div style="font-size: 14px; color: #6e6e73;">Avg. Confidence</div>
                        </div>
                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #f59e0b; margin-bottom: 8px;">3</div>
                            <div style="font-size: 14px; color: #6e6e73;">Active Teams</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div class="content-view" id="settings-view">
                <div class="content-header">
                    <h1 class="page-title">Settings</h1>
                </div>
                <div class="content-body">
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <h3 class="empty-state-title">Settings</h3>
                        <p class="empty-state-desc">
                            Configure your workspace preferences, team settings, and integration options.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Metadata Panel -->
    <div id="metadataPanel" style="position: fixed; top: 0; right: -400px; width: 400px; height: 100vh; background: white; border-left: 1px solid #e5e7eb; box-shadow: -4px 0 12px rgba(0,0,0,0.1); transition: right 0.3s ease; z-index: 1000; overflow-y: auto;">
        <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 18px; font-weight: 600; color: #171719;">
                <i class="fas fa-info-circle"></i>
                Report Details
            </div>
            <button onclick="closeMetadataPanel()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: #6b7280; padding: 4px;">×</button>
        </div>
        <div id="metadataContent" style="padding: 24px;">
            <!-- Metadata content will be dynamically generated -->
        </div>
    </div>

    <script>
        // Global variables
        let currentView = 'get-started';
        let selectedDataSource = null;
        let allReports = [];
        let filteredReports = [];
        let selectedReports = [];
        let currentReportView = 'list';
        let activeFilters = {
            team: ['integrated', 'marketing', 'finance', 'sales'],
            module: ['integrated', 'segmentation', 'prediction', 'roi', 'behavior', 'campaign'],
            period: ['week', 'month'],
            status: ['latest']
        };
        
        // Workspace variables
        let selectedColumns = [];
        let selectedColumnData = null;
        let columnMetadata = {};
        let currentDataset = null;

        // Data source selection
        function selectDataSource(source) {
            // Remove previous selection
            document.querySelectorAll('.data-source-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Select current
            event.currentTarget.classList.add('selected');
            selectedDataSource = source;

            // Enable proceed button
            document.getElementById('proceedBtn').disabled = false;
        }

        function proceedWithDataSource() {
            if (!selectedDataSource) return;

            if (selectedDataSource === 'aws') {
                switchView('integration');
            } else {
                // Load demo data and go to workspace
                loadDemoData();
                switchView('workspace');
            }
        }

        function loadDemoData() {
            // Initialize demo reports
            allReports = generateSampleReports();
            applyFilters();
            
            // Show success message
            setTimeout(() => {
                alert('Demo dataset loaded successfully! You can now explore the workspace and generate reports.');
            }, 500);
        }

        // 사이드바 토글 함수
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.querySelector('.main-content');
            
            sidebar.classList.toggle('collapsed');
            
            // 메인 콘텐츠 마진 조정
            if (sidebar.classList.contains('collapsed')) {
                if (mainContent) {
                    mainContent.style.marginLeft = '60px';
                }
            } else {
                if (mainContent) {
                    mainContent.style.marginLeft = '240px';
                }
            }
        }

        // 통합 리포트 테스트 함수
        // 이 함수는 더 이상 사용하지 않음 - switchView('discussion')으로 대체됨
        function testDiscussionView() {
            console.log('testDiscussionView is deprecated, use switchView("discussion") instead');
            switchView('discussion');
        }

        // Navigation
        function switchView(view) {
            console.log('Switching to view:', view);
            
            // Update nav items - 더 안전한 방법으로
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // 해당 뷰를 호출하는 nav-item 직접 찾아서 활성화
            document.querySelectorAll('.nav-item').forEach(item => {
                const onclick = item.getAttribute('onclick');
                if (onclick && onclick.includes(`switchView('${view}')`)) {
                    item.classList.add('active');
                    console.log('Activated nav item for view:', view);
                }
            });

            // Update content views - CSS 클래스만 사용
            document.querySelectorAll('.content-view').forEach(viewEl => {
                viewEl.classList.remove('active');
                // 인라인 스타일 제거하여 CSS 우선순위 복원
                viewEl.style.display = '';
            });
            
            // 타겟 뷰 찾기 및 표시 - 더 강력하게
            const targetViewId = view + '-view';
            let targetView = document.getElementById(targetViewId);
            
            console.log('Looking for target view:', targetViewId);
            console.log('Found target view:', !!targetView);
            
            if (targetView) {
                // CSS 클래스 기반 표시 (인라인 스타일 제거)
                targetView.classList.add('active');
                console.log('Successfully activated view:', targetViewId);
                
                // discussion view의 경우 특별 처리
                if (view === 'discussion') {
                    // 짧은 지연 후 초기화하여 DOM이 완전히 표시된 후 실행
                    setTimeout(() => {
                        initializeIntegratedDiscussion();
                    }, 50);
                }
                
                // 추가 확인
                setTimeout(() => {
                    const check = document.getElementById(targetViewId);
                    const computed = window.getComputedStyle(check);
                    console.log('Final display check:', computed.display, computed.visibility);
                }, 100);
            } else {
                console.error('View not found:', targetViewId);
                // 모든 content-view들의 ID를 출력해서 디버깅
                const allViews = document.querySelectorAll('.content-view');
                console.log('Available views:', Array.from(allViews).map(v => v.id));
            }

            currentView = view;

            // Load content based on view
            if (view === 'report-hub') {
                if (allReports.length === 0) {
                    allReports = generateSampleReports();
                    applyFilters();
                }
                updateReportsList();
            } else if (view === 'discussion') {
                // 통합 토론 전용 초기화
                console.log('Initializing Integrated Discussion view');
                initializeIntegratedDiscussion();
            }
        }

        // 통합 토론 초기화 함수 (내부 기능은 토론 중심, 화면은 리포트 표시)
        function initializeIntegratedDiscussion() {
            console.log('Integrated Report view initialized with discussion features');
            
            // discussion-view 컴포넌트 초기화
            const discussionView = document.getElementById('discussion-view');
            if (discussionView) {
                console.log('Discussion view found, initializing components');
                
                const reportWorkspace = discussionView.querySelector('.report-workspace');
                if (reportWorkspace) {
                    console.log('Report workspace found and ready');
                }
            }
            
            // 리포트 탭 기능 확인 및 강화
            const reportTabs = document.querySelectorAll('.report-tab');
            if (reportTabs.length > 0) {
                console.log('Found', reportTabs.length, 'report tabs');
                // 첫 번째 탭이 활성화되어 있는지 확인
                const activeTab = document.querySelector('.report-tab.active');
                if (!activeTab && reportTabs.length > 0) {
                    reportTabs[0].classList.add('active');
                    console.log('Activated first report tab');
                    
                    // 해당 탭 내용도 표시
                    const firstTabContent = document.querySelector('.tab-content.active');
                    if (!firstTabContent) {
                        const allTabContents = document.querySelectorAll('.tab-content');
                        if (allTabContents.length > 0) {
                            allTabContents[0].classList.add('active');
                            allTabContents[0].style.display = 'block';
                            console.log('Activated first tab content');
                        }
                    }
                }
            }
            
            // 채팅 메시지 영역 스크롤 확인
            const chatMessages = document.getElementById('reportChatMessages');
            if (chatMessages) {
                chatMessages.style.display = 'block';
                chatMessages.scrollTop = chatMessages.scrollHeight;
                console.log('Chat messages area activated');
            }
            
            // 실시간 채팅 기능 초기화 (토론 중심 기능)
            const chatInput = document.getElementById('reportMessageInput');
            if (chatInput) {
                console.log('Discussion-enabled chat input found and ready');
                // 채팅 기능을 토론 중심으로 활성화
                chatInput.placeholder = 'Enter your message...';
            }
            
            // 팀 협업 상태 업데이트
            updateTeamCollaborationStatus();
            
            // 최종 확인
            setTimeout(() => {
                const finalCheck = document.getElementById('discussion-view');
                const computedStyle = window.getComputedStyle(finalCheck);
                console.log('Final check - display:', computedStyle.display, 'visibility:', computedStyle.visibility);
            }, 100);
        }

        // 팀 협업 상태 업데이트 함수
        function updateTeamCollaborationStatus() {
            console.log('Updating team collaboration status for discussion');
            // 온라인 사용자 상태 등을 업데이트할 수 있음
        }

        // Generate sample reports data
        function generateSampleReports() {
            const teams = [
                { id: 'marketing', name: 'Marketing Team', icon: 'fas fa-chart-line' },
                { id: 'finance', name: 'Finance Team', icon: 'fas fa-dollar-sign' },
                { id: 'sales', name: 'Sales Team', icon: 'fas fa-bullseye' },
                { id: 'integrated', name: 'Integrated Analysis', icon: 'fas fa-handshake' }
            ];

            const modules = [
                { id: 'segmentation', name: 'Segmentation' },
                { id: 'prediction', name: 'Prediction Analysis' },
                { id: 'roi', name: 'ROI Analysis' },
                { id: 'behavior', name: 'Behavior Analysis' },
                { id: 'campaign', name: 'Campaign Analysis' },
                { id: 'integrated', name: 'Integrated Analysis' }
            ];

            const reports = [
                {
                    id: 'rpt_001',
                    title: 'Q3 Customer Segmentation Analysis v3.2',
                    team: 'marketing',
                    module: 'segmentation',
                    date: '2025-09-08',
                    author: 'Marketing Team',
                    version: '3.2',
                    status: 'latest',
                    conditions: 'age: 20-40, region: Seoul, purchasing_power: top 30%',
                    path: 'Workspace → Marketing Agent → Segmentation Module',
                    agent: 'Segmentation',
                    dataSource: 'master_customer_v2.3',
                    reliability: '94%',
                    previousVersions: ['3.1', '3.0', '2.8'],
                    linkedReports: [{
                        id: 'rpt_015',
                        title: 'Q3 Sales Target Customer Analysis'
                    }, {
                        id: 'rpt_023',
                        title: 'Customer Segment-based Marketing Strategy'
                    }],
                    tags: ['Q3', 'customer-analysis', 'segmentation']
                },
                {
                    id: 'rpt_002',
                    title: 'Q3 Customer Segmentation Analysis v3.1',
                    team: 'marketing',
                    module: 'segmentation',
                    date: '2025-09-05',
                    author: 'Marketing Team',
                    version: '3.1',
                    status: 'versioned',
                    conditions: 'age: 20-40, region: Seoul+Gyeonggi, purchasing_power: top 30%',
                    path: 'Workspace → Marketing Agent → Segmentation Module',
                    agent: 'Segmentation Agent',
                    dataSource: 'master_customer_v2.2',
                    reliability: '92%',
                    previousVersions: ['3.0', '2.8'],
                    linkedReports: [{
                        id: 'rpt_015',
                        title: 'Q3 Sales Target Customer Analysis'
                    }],
                    tags: ['Q3', 'customer-analysis', 'segmentation', 'previous-version']
                },
                {
                    id: 'rpt_003',
                    title: 'Q3 Marketing ROI Optimization Analysis',
                    team: 'finance',
                    module: 'roi',
                    date: '2025-09-07',
                    author: 'Finance Team',
                    version: '2.1',
                    status: 'latest',
                    conditions: 'campaign_period: Q3, budget_range: 100M-500M, channel: digital',
                    path: 'Workspace → Finance Agent → ROI Analysis Module',
                    agent: 'ROI Analysis',
                    dataSource: 'marketing_spend_v1.8',
                    reliability: '96%',
                    previousVersions: ['2.0', '1.9'],
                    linkedReports: [{
                        id: 'rpt_001',
                        title: 'Q3 Customer Segmentation Analysis v3.2'
                    }, {
                        id: 'rpt_008',
                        title: 'Department Budget Optimization Analysis 2025'
                    }],
                    tags: ['Q3', 'ROI', 'marketing-efficiency']
                },
                {
                    id: 'rpt_004',
                    title: 'Sales Pipeline Prediction Model Q4',
                    team: 'sales',
                    module: 'prediction',
                    date: '2025-09-06',
                    author: 'Sales Team',
                    version: '4.0',
                    status: 'latest',
                    conditions: 'forecast_period: Q4, confidence: 85%+, stage: qualified+',
                    path: 'Workspace → Sales Agent → Prediction Analysis Module',
                    agent: 'Prediction Analysis',
                    dataSource: 'sales_pipeline_v3.1',
                    reliability: '89%',
                    previousVersions: ['3.8', '3.5', '3.2'],
                    linkedReports: [{
                        id: 'rpt_003',
                        title: 'Q3 Marketing ROI Optimization Analysis'
                    }, {
                        id: 'rpt_012',
                        title: 'Q4 Budget Planning Analysis'
                    }],
                    tags: ['Q4', 'sales-prediction', 'pipeline']
                },
                {
                    id: 'rpt_005',
                    title: 'Integrated Customer Journey Analysis (Marketing+Sales)',
                    team: 'integrated',
                    module: 'integrated',
                    date: '2025-09-08',
                    author: 'Integrated Agent',
                    version: '1.5',
                    status: 'latest',
                    conditions: 'teams: marketing+sales, journey_stage: all, touchpoints: 5+',
                    path: 'Integrated Workspace → Collaboration Analysis → Integrated Module',
                    agent: 'Integrated Analysis',
                    dataSource: 'integrated_customer_v1.2',
                    reliability: '97%',
                    previousVersions: ['1.4', '1.3'],
                    linkedReports: [{
                        id: 'rpt_001',
                        title: 'Q3 Customer Segmentation Analysis v3.2'
                    }, {
                        id: 'rpt_004',
                        title: 'Sales Pipeline Prediction Model Q4'
                    }, {
                        id: 'rpt_015',
                        title: 'Q3 Sales Target Customer Analysis'
                    }],
                    tags: ['integrated-analysis', 'customer-journey', 'collaboration']
                },
                {
                    id: 'rpt_006',
                    title: 'Brand Awareness Campaign Effect Analysis',
                    team: 'marketing',
                    module: 'campaign',
                    date: '2025-09-04',
                    author: 'Marketing Team',
                    version: '2.3',
                    status: 'latest',
                    conditions: 'campaign_type: brand_awareness, duration: 30days, channels: tv+digital',
                    path: 'Workspace → Marketing Agent → Campaign Analysis Module',
                    agent: 'Campaign Analysis',
                    dataSource: 'campaign_data_v2.1',
                    reliability: '91%',
                    previousVersions: ['2.2', '2.0'],
                    linkedReports: [{
                        id: 'rpt_003',
                        title: 'Q3 Marketing ROI Optimization Analysis'
                    }],
                    tags: ['brand', 'campaign', 'awareness']
                },
                {
                    id: 'rpt_007',
                    title: 'Customer Churn Prediction and Prevention Strategy',
                    team: 'marketing',
                    module: 'behavior',
                    date: '2025-09-03',
                    author: 'Marketing Team',
                    version: '3.7',
                    status: 'latest',
                    conditions: 'churn_risk: high, segment: premium, activity: 30days',
                    path: 'Workspace → Marketing Agent → Behavior Analysis Module',
                    agent: 'Behavior Analysis',
                    dataSource: 'customer_activity_v2.8',
                    reliability: '93%',
                    previousVersions: ['3.6', '3.4', '3.1'],
                    linkedReports: [{
                        id: 'rpt_001',
                        title: 'Q3 Customer Segmentation Analysis v3.2'
                    }, {
                        id: 'rpt_005',
                        title: 'Integrated Customer Journey Analysis (Marketing+Sales)'
                    }],
                    tags: ['churn-prediction', 'customer-behavior', 'prevention-strategy']
                },
                {
                    id: 'rpt_008',
                    title: 'Department Budget Optimization Analysis 2025',
                    team: 'finance',
                    module: 'roi',
                    date: '2025-09-02',
                    author: 'Finance Team',
                    version: '1.8',
                    status: 'latest',
                    conditions: 'year: 2025, departments: all, optimization: cost_efficiency',
                    path: 'Workspace → Finance Agent → ROI Analysis Module',
                    agent: 'ROI Analysis',
                    dataSource: 'budget_allocation_v1.5',
                    reliability: '95%',
                    previousVersions: ['1.7', '1.6'],
                    linkedReports: [{
                        id: 'rpt_003',
                        title: 'Q3 Marketing ROI Optimization Analysis'
                    }, {
                        id: 'rpt_004',
                        title: 'Sales Pipeline Prediction Model Q4'
                    }],
                    tags: ['budget-optimization', 'department', '2025']
                }
            ];

            return reports.map(report => {
                const team = teams.find(t => t.id === report.team);
                const module = modules.find(m => m.id === report.module);
                
                return {
                    ...report,
                    teamName: team ? team.name : report.team,
                    teamIcon: team ? team.icon : 'fas fa-chart-bar',
                    moduleName: module ? module.name : report.module,
                    formattedDate: new Date(report.date).toLocaleDateString('en-US', { 
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    }),
                    searchText: [
                        report.title,
                        report.conditions,
                        report.author,
                        report.tags.join(' '),
                        team ? team.name : '',
                        module ? module.name : ''
                    ].join(' ').toLowerCase()
                };
            });
        }

        // Filter functions
        function toggleFilter(element, category, value) {
            const checkbox = element.querySelector('.filter-checkbox');
            const isChecked = checkbox.classList.contains('checked');
            
            if (isChecked) {
                checkbox.classList.remove('checked');
                activeFilters[category] = activeFilters[category].filter(item => item !== value);
            } else {
                checkbox.classList.add('checked');
                activeFilters[category].push(value);
            }
            
            applyFilters();
            updateReportsList();
        }

        function applyFilters() {
            const searchQuery = document.getElementById('hubSearchInput')?.value.toLowerCase() || '';
            const startDate = document.getElementById('startDate')?.value || '';
            const endDate = document.getElementById('endDate')?.value || '';
            
            filteredReports = allReports.filter(report => {
                // Text search
                if (searchQuery && !report.searchText.includes(searchQuery)) {
                    return false;
                }
                
                // Date range
                if (startDate && report.date < startDate) return false;
                if (endDate && report.date > endDate) return false;
                
                // Category filters
                if (!activeFilters.team.includes(report.team)) return false;
                if (!activeFilters.module.includes(report.module)) return false;
                if (!activeFilters.status.includes(report.status)) return false;
                
                // Period filter
                if (activeFilters.period.length > 0) {
                    const reportDate = new Date(report.date);
                    const today = new Date();
                    const daysDiff = Math.floor((today - reportDate) / (1000 * 60 * 60 * 24));
                    
                    let matchesPeriod = false;
                    if (activeFilters.period.includes('today') && daysDiff === 0) matchesPeriod = true;
                    if (activeFilters.period.includes('week') && daysDiff <= 7) matchesPeriod = true;
                    if (activeFilters.period.includes('month') && daysDiff <= 30) matchesPeriod = true;
                    if (activeFilters.period.includes('quarter') && daysDiff <= 90) matchesPeriod = true;
                    
                    if (!matchesPeriod) return false;
                }
                
                return true;
            });
        }

        function applySorting() {
            const sortValue = document.getElementById('sortSelect')?.value || 'date-desc';
            
            filteredReports.sort((a, b) => {
                switch (sortValue) {
                    case 'date-desc':
                        return new Date(b.date) - new Date(a.date);
                    case 'date-asc':
                        return new Date(a.date) - new Date(b.date);
                    case 'name-asc':
                        return a.title.localeCompare(b.title);
                    case 'team-asc':
                        return a.teamName.localeCompare(b.teamName);
                    case 'module-asc':
                        return a.moduleName.localeCompare(b.moduleName);
                    default:
                        return 0;
                }
            });
        }

        function updateReportsList() {
            applySorting();
            
            const container = document.getElementById('reportsList');
            if (!container) return;
            
            if (filteredReports.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="empty-state-title">No reports found</h3>
                        <p class="empty-state-desc">Try adjusting your filters or search terms.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredReports.map(report => `
                <div class="report-item ${selectedReports.includes(report.id) ? 'selected' : ''}" 
                     data-report-id="${report.id}"
                     onclick="toggleReportSelection('${report.id}')">
                    <div class="report-header">
                        <div>
                            <div class="report-title">${report.title}</div>
                            <div class="report-meta">
                                <div class="meta-item">
                                    <i class="${report.teamIcon} meta-icon"></i>
                                    <span>${report.teamName}</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-calendar-alt meta-icon"></i>
                                    <span>${report.formattedDate}</span>
                                </div>
                                ${report.agent === 'Integrated Analysis' ? `<div class="meta-item">
                                    <i class="fas fa-users meta-icon"></i>
                                    <span>${Math.floor(Math.random() * 3) + 2} teams</span>
                                </div>` : ''}
                                <div class="meta-item">
                                    <i class="fas fa-chart-bar meta-icon"></i>
                                    <span>${report.reliability} reliability</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-code-branch meta-icon"></i>
                                    <span>v${report.version}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-tags">
                        <span class="tag team">${report.teamName}</span>
                        <span class="tag module">${report.moduleName}</span>
                        <span class="tag version">v${report.version}</span>
                        ${report.status === 'latest' ? '<span class="tag status">Latest</span>' : ''}
                        ${report.previousVersions.length > 0 ? `<span class="tag version">${report.previousVersions.length} previous versions</span>` : ''}
                    </div>
                    
                    <div class="report-actions">
                        <button class="report-action" onclick="event.stopPropagation(); showReportDetail('${report.id}')">View Details</button>
                        <button class="report-action" onclick="event.stopPropagation(); showMetadata('${report.id}')">Metadata</button>
                        ${report.previousVersions.length > 0 ? 
                            `<button class="report-action" onclick="event.stopPropagation(); showVersionHistory('${report.id}')">Version History</button>` : ''}
                        ${report.linkedReports.length > 0 ? 
                            `<button class="report-action" onclick="event.stopPropagation(); showLinkedReports('${report.id}')">Related Reports (${report.linkedReports.length})</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function toggleReportSelection(reportId) {
            if (selectedReports.includes(reportId)) {
                selectedReports = selectedReports.filter(id => id !== reportId);
            } else {
                if (selectedReports.length < 4) {
                    selectedReports.push(reportId);
                } else {
                    alert('You can compare up to 4 reports at once.');
                    return;
                }
            }
            
            updateReportsList();
            updateCompareButton();
        }

        function updateCompareButton() {
            const compareBtn = document.getElementById('compareBtn');
            const count = document.getElementById('compareCount');
            if (count) count.textContent = selectedReports.length;
            
            if (compareBtn) {
                if (selectedReports.length < 2) {
                    compareBtn.style.opacity = '0.5';
                    compareBtn.style.cursor = 'not-allowed';
                } else {
                    compareBtn.style.opacity = '1';
                    compareBtn.style.cursor = 'pointer';
                }
            }
        }

        function switchReportView(view) {
            if (view === 'compare' && selectedReports.length < 2) {
                alert('Please select at least 2 reports to compare.');
                return;
            }
            
            currentReportView = view;
            
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (view === 'list') {
                document.getElementById('listView').style.display = 'block';
                document.getElementById('comparisonView').style.display = 'none';
            } else {
                document.getElementById('listView').style.display = 'none';
                document.getElementById('comparisonView').style.display = 'block';
                updateComparisonView();
            }
        }

        function updateComparisonView() {
            const container = document.getElementById('comparisonGrid');
            if (!container) return;
            
            const selectedReportObjects = selectedReports.map(id => allReports.find(r => r.id === id));
            
            container.innerHTML = `
                <div style="background: linear-gradient(135deg, #667eea20, #764ba220); border-radius: 12px; padding: 24px; margin-bottom: 32px; border: 2px solid #e0e7ff;">
                    <div style="font-size: 18px; font-weight: 600; color: #171719; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-chart-bar"></i> Comparison Summary
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="background: white; border-radius: 8px; padding: 16px; text-align: center; border: 1px solid #e5e7eb;">
                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">${selectedReportObjects.length}</div>
                            <div style="font-size: 12px; color: #6b7280;">Selected Reports</div>
                        </div>
                        <div style="background: white; border-radius: 8px; padding: 16px; text-align: center; border: 1px solid #e5e7eb;">
                            <div style="font-size: 24px; font-weight: 700; color: #667eea; margin-bottom: 4px;">${new Set(selectedReportObjects.map(r => r.team)).size}</div>
                            <div style="font-size: 12px; color: #6b7280;">Teams Involved</div>
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 24px;">
                    ${selectedReports.map(id => {
                        const report = allReports.find(r => r.id === id);
                        return `
                            <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px;">
                                <div style="border-bottom: 1px solid #f3f4f6; padding-bottom: 16px; margin-bottom: 20px;">
                                    <div style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 8px;">${report.title}</div>
                                    <div style="font-size: 13px; color: #6b7280;">
                                        <i class="${report.teamIcon}"></i> ${report.teamName} • v${report.version} • ${report.formattedDate}
                                    </div>
                                </div>
                                
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 8px;">Analysis Module</div>
                                    <div style="font-size: 13px; color: #6b7280; line-height: 1.5;">${report.agent}</div>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 8px;">Data Source</div>
                                    <div style="font-size: 13px; color: #6b7280; line-height: 1.5;">${report.dataSource}</div>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 8px;">Reliability Score</div>
                                    <div style="font-size: 13px; color: #6b7280;">${report.reliability}</div>
                                </div>
                                
                                ${report.linkedReports.length > 0 ? `
                                <div>
                                    <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 8px;">Related Reports</div>
                                    <div style="font-size: 13px; color: #6b7280;">
                                        ${report.linkedReports.map(linked => 
                                            `<div style="display: inline-block; background: #f3e8ff; border: 1px solid #9c27b0; border-radius: 4px; padding: 2px 6px; margin: 2px; font-size: 11px; color: #4a148c;">${linked.title}</div>`
                                        ).join('')}
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function showMetadata(reportId) {
            const report = allReports.find(r => r.id === reportId);
            const panel = document.getElementById('metadataPanel');
            const content = document.getElementById('metadataContent');
            
            if (content) {
                content.innerHTML = `
                    <div style="margin-bottom: 24px;">
                        <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #f3f4f6;">Basic Information</div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Report ID</div>
                            <div style="font-size: 14px; color: #171719;">${report.id}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Title</div>
                            <div style="font-size: 14px; color: #171719;">${report.title}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Author</div>
                            <div style="font-size: 14px; color: #171719;">${report.author}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Created Date</div>
                            <div style="font-size: 14px; color: #171719;">${report.formattedDate}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Version</div>
                            <div style="font-size: 14px; color: #171719;">v${report.version}</div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 24px;">
                        <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #f3f4f6;">Analysis Details</div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Conditions</div>
                            <div style="background: #f8f9fa; border-radius: 6px; padding: 8px 12px; font-family: 'Geist Mono', monospace; font-size: 11px; color: #374151;">${report.conditions}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Analysis Path</div>
                            <div style="font-size: 14px; color: #171719;">${report.path}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Data Source</div>
                            <div style="background: #f8f9fa; border-radius: 6px; padding: 8px 12px; font-family: 'Geist Mono', monospace; font-size: 11px; color: #374151;">${report.dataSource}</div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 24px;">
                        <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #f3f4f6;">Quality Metrics</div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Reliability Score</div>
                            <div style="font-size: 14px; color: #171719;">${report.reliability}</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Analysis Module</div>
                            <div style="font-size: 14px; color: #171719;">${report.agent}</div>
                        </div>
                    </div>
                    
                    ${report.linkedReports.length > 0 ? `
                    <div style="margin-bottom: 24px;">
                        <div style="font-size: 14px; font-weight: 600; color: #171719; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #f3f4f6;">Related Reports</div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 14px; color: #171719;">${report.linkedReports.map(linked => linked.title).join(', ')}</div>
                        </div>
                    </div>
                    ` : ''}
                `;
            }
            
            if (panel) {
                panel.style.right = '0';
            }
        }

        function closeMetadataPanel() {
            const panel = document.getElementById('metadataPanel');
            if (panel) {
                panel.style.right = '-400px';
            }
        }

        function showReportDetail(reportId) {
            const report = allReports.find(r => r.id === reportId);
            alert(`Report Details: ${report.title}\n\nIn a real implementation, this would open the detailed report viewer.`);
        }

        function showVersionHistory(reportId) {
            const report = allReports.find(r => r.id === reportId);
            alert(`Version History: ${report.title}\nCurrent: v${report.version}\nPrevious: ${report.previousVersions.join(', ')}`);
        }

        function showLinkedReports(reportId) {
            const report = allReports.find(r => r.id === reportId);
            const linkedTitles = report.linkedReports.map(linked => `• ${linked.title}`).join('\n');
            alert(`Related Reports:\n\n${linkedTitles}\n\nIn a real implementation, you could click to navigate to these reports.`);
        }

        // Workspace functions
        function switchWorkspaceTab(tabName) {
            document.querySelectorAll('.team-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            event.target.classList.add('active');
            const targetTab = document.getElementById(tabName + '-tab');
            if (targetTab) {
                targetTab.classList.add('active');
            }
        }

        function sendWorkspaceMessage() {
            const input = document.getElementById('workspaceMessageInput');
            const message = input?.value.trim();
            
            if (!message) return;
            
            const now = new Date();
            const time = now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            
            const chatMessages = document.getElementById('workspaceChatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar" style="background: #667eea;">Me</div>
                    <span class="message-author">You</span>
                    <span class="message-time">${time}</span>
                </div>
                <div class="message-content">${message}</div>
            `;
            
            if (chatMessages) {
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            if (input) input.value = '';
        }

        // User menu
        function showUserMenu() {
            alert('User menu would show options like:\n• Profile Settings\n• Team Management\n• Logout');
        }

        // Event listeners
        function setupEventListeners() {
            // Search input
            const searchInput = document.getElementById('hubSearchInput');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    applyFilters();
                    updateReportsList();
                });
            }
            
            // Date inputs
            const startDate = document.getElementById('startDate');
            const endDate = document.getElementById('endDate');
            if (startDate) {
                startDate.addEventListener('change', () => {
                    applyFilters();
                    updateReportsList();
                });
            }
            if (endDate) {
                endDate.addEventListener('change', () => {
                    applyFilters();
                    updateReportsList();
                });
            }
            
            // Sort select
            const sortSelect = document.getElementById('sortSelect');
            if (sortSelect) {
                sortSelect.addEventListener('change', updateReportsList);
            }
            
            // Workspace message input
            const workspaceMessageInput = document.getElementById('workspaceMessageInput');
            if (workspaceMessageInput) {
                workspaceMessageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendWorkspaceMessage();
                    }
                });
            }
            
            // ESC key for closing panels
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeMetadataPanel();
                }
            });
        }

        // Initialize
        function initialize() {
            setupEventListeners();
            updateCompareButton();
            
            // Auto-scroll chat
            const chatMessages = document.getElementById('workspaceChatMessages');
            if (chatMessages) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // 3-Panel Workspace Functions
        
        // Master data selection
        function selectMasterData() {
            // Remove team data selections
            document.querySelectorAll('.team-request-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Highlight master data selection
            const masterSection = document.querySelector('.master-data-section');
            masterSection.style.background = '#e0e7ff';
            masterSection.style.borderColor = '#667eea';
            
            // Show editing interface
            document.getElementById('empty-state').style.display = 'none';
            document.getElementById('column-interface').style.display = 'flex';
            
            // Reset to master data view
            resetToMasterData();
            
            currentDataset = 'master';
            showNotification('Master dataset selected for editing');
        }
        
        // Toggle select all columns
        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAllColumns');
            const checkboxes = document.querySelectorAll('.column-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
                if (selectAll.checked) {
                    const columnName = checkbox.dataset.column;
                    if (!selectedColumns.find(col => col.name === columnName)) {
                        selectedColumns.push({
                            name: columnName,
                            type: getColumnType(columnName),
                            group: 'Selected'
                        });
                    }
                } else {
                    selectedColumns = [];
                }
            });
            
            updateSelectedCount();
            updateWorkspaceColumns();
            updateDuplicationCheck();
        }
        
        // Toggle individual column
        function toggleColumn(checkbox) {
            const columnName = checkbox.dataset.column;
            
            if (checkbox.checked) {
                if (!selectedColumns.find(col => col.name === columnName)) {
                    selectedColumns.push({
                        name: columnName,
                        type: getColumnType(columnName),
                        group: 'Selected'
                    });
                }
            } else {
                selectedColumns = selectedColumns.filter(col => col.name !== columnName);
                document.getElementById('selectAllColumns').checked = false;
            }
            
            updateSelectedCount();
            updateWorkspaceColumns();
            updateDuplicationCheck();
        }
        
        // Get column type
        function getColumnType(columnName) {
            const types = {
                'customer_id': 'String',
                'customer_name': 'String', 
                'email': 'String',
                'amount': 'Number',
                'purchase_date': 'Date',
                'age_group': 'String',
                'region': 'String',
                'product_category': 'String',
                'payment_method': 'String',
                'phone': 'String'
            };
            return types[columnName] || 'String';
        }
        
        // Update selected count
        function updateSelectedCount() {
            document.getElementById('selectedCount').textContent = selectedColumns.length;
        }
        
        // Show alias dialog
        function showAliasDialog(columnName) {
            const alias = prompt(`Enter alias for ${columnName}:`, columnName);
            if (alias && alias !== columnName) {
                columnMetadata[columnName] = columnMetadata[columnName] || {};
                columnMetadata[columnName].alias = alias;
                showNotification(`Alias set for ${columnName}: ${alias}`);
                updateColumnDisplay(columnName);
            }
        }
        
        // Show description dialog  
        function showDescDialog(columnName) {
            const description = prompt(`Enter description for ${columnName}:`);
            if (description) {
                columnMetadata[columnName] = columnMetadata[columnName] || {};
                columnMetadata[columnName].description = description;
                showNotification(`Description added for ${columnName}`);
                updateColumnDisplay(columnName);
            }
        }
        
        // Update column display to show alias/description
        function updateColumnDisplay(columnName) {
            const columnItems = document.querySelectorAll('.column-item');
            columnItems.forEach(item => {
                const checkbox = item.querySelector('.column-checkbox');
                if (checkbox && checkbox.dataset.column === columnName) {
                    const columnInfo = item.querySelector('.column-info');
                    if (columnInfo) {
                        const metadata = columnMetadata[columnName];
                        let metadataHtml = '';
                        if (metadata) {
                            if (metadata.alias) {
                                metadataHtml += `<div style="font-size: 10px; color: #667eea; margin-top: 2px;">Alias: ${metadata.alias}</div>`;
                            }
                            if (metadata.description) {
                                metadataHtml += `<div style="font-size: 10px; color: #8e8e93; margin-top: 2px;">${metadata.description}</div>`;
                            }
                        }
                        
                        // Update column info to include metadata
                        const columnName = item.querySelector('.column-name').textContent;
                        const columnType = item.querySelector('.column-type').textContent;
                        columnInfo.innerHTML = `
                            <span class="column-name" style="font-weight: 500; color: #1d1d1f;">${columnName}</span>
                            <span class="column-type" style="color: #6e6e73; margin-left: 8px;">${columnType}</span>
                            ${metadataHtml}
                        `;
                    }
                }
            });
            
            // Also update workspace columns if they are already selected
            updateWorkspaceColumns();
        }
        
        
        // Synthetic data functions
        function selectSyntheticOption(option) {
            const augmentDetailOptions = document.getElementById('augmentDetailOptions');
            const requestNotification = document.getElementById('requestNotification');
            
            if (option === 'enable') {
                augmentDetailOptions.style.display = 'block';
                requestNotification.style.display = 'none';
            } else {
                augmentDetailOptions.style.display = 'none';
                requestNotification.style.display = 'none';
            }
        }
        
        function updateAugmentMethod() {
            const requestNotification = document.getElementById('requestNotification');
            const crawling = document.getElementById('crawling').checked;
            const row = document.getElementById('row').checked;
            const missing = document.getElementById('missing').checked;
            
            if (crawling || row || missing) {
                requestNotification.style.display = 'block';
            } else {
                requestNotification.style.display = 'none';
            }
        }
        
        // Update duplication check based on selected columns
        function updateDuplicationCheck() {
            const duplicateSection = document.getElementById('duplicate-check-section');
            const duplicateIndicator = document.getElementById('duplicate-indicator');
            const duplicateScore = document.getElementById('duplicate-score');
            const duplicateTeamInfo = document.getElementById('duplicate-team-info');
            const duplicateColumns = document.getElementById('duplicate-columns');
            
            if (selectedColumns.length === 0) {
                duplicateIndicator.style.display = 'none';
                document.getElementById('related-reports-section').style.display = 'none';
                duplicateIndicator.innerHTML = `
                    <div style="text-align: center; color: #6e6e73; font-size: 13px; padding: 20px;">
                        <i class="fas fa-search" style="font-size: 24px; margin-bottom: 8px; color: #9ca3af;"></i>
                        <div>No columns selected</div>
                        <div style="font-size: 11px; margin-top: 4px;">Select columns to check for duplications</div>
                    </div>
                `;
                return;
            }
            
            duplicateIndicator.style.display = 'block';
            
            // Calculate mock duplication based on selected columns
            const commonColumns = selectedColumns.filter(col => 
                ['customer_id', 'purchase_date', 'amount'].includes(col.name)
            );
            
            const duplicationRate = Math.max(15, Math.min(95, commonColumns.length * 25 + Math.random() * 20));
            const level = duplicationRate > 70 ? 'High' : duplicationRate > 40 ? 'Medium' : 'Low';
            const color = duplicationRate > 70 ? '#ef4444' : duplicationRate > 40 ? '#f59e0b' : '#10b981';
            
            duplicateIndicator.innerHTML = `
                <div class="duplicate-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <div class="duplicate-score" style="font-size: 16px; font-weight: 600; color: ${color};">${Math.round(duplicationRate)}% Duplication</div>
                    <div style="font-size: 12px; color: #6b7280;">${level}</div>
                </div>
                <div class="duplicate-team-info" style="font-size: 12px; color: #6e6e73; margin-bottom: 4px;">
                    ${level} similarity with ${duplicationRate > 50 ? 'Marketing' : 'Finance'} Team dataset
                </div>
                <div class="duplicate-columns" style="font-size: 11px; color: #8e8e93;">
                    Common columns: ${commonColumns.map(col => col.name).join(', ') || 'None'}
                </div>
            `;
            
            // Check for related reports
            checkForRelatedReports(selectedColumns);
        }
        
        // Export data
        function exportData(format) {
            showNotification(`Exporting data as ${format.toUpperCase()}...`);
        }
        
        // Generate dataset
        function generateData() {
            if (selectedColumns.length === 0) {
                showNotification('Please select columns to generate dataset');
                return;
            }
            
            const enableOption = document.getElementById('enable');
            const crawlingOption = document.getElementById('crawling');
            const rowOption = document.getElementById('row');
            const missingOption = document.getElementById('missing');
            
            // Check if augmentation is enabled and methods are selected
            if (enableOption && enableOption.checked && 
                ((crawlingOption && crawlingOption.checked) || 
                 (rowOption && rowOption.checked) || 
                 (missingOption && missingOption.checked))) {
                addAugmentingTeamDataRequest(selectedColumns);
            } else {
                createTeamDataset();
            }
        }
        
        // Add augmenting team data request
        function addAugmentingTeamDataRequest(columns) {
            const teamRequestsContainer = document.querySelector('.team-requests');
            const newRequestId = 'augmenting-request-' + Date.now();
            
            const newRequestCard = document.createElement('div');
            newRequestCard.className = 'team-request-card new-request';
            newRequestCard.style.cssText = 'background: white; border: 2px solid #f59e0b; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease; animation: pulse 2s infinite;';
            newRequestCard.onclick = () => selectTeamData(newRequestId);
            
            newRequestCard.innerHTML = `
                <div class="team-info" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <div class="team-avatar" style="width: 24px; height: 24px; background: #f59e0b; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;"><i class="fas fa-flask"></i></div>
                    <div class="team-name" style="font-weight: 600; color: #1d1d1f;">Augmenting Dataset</div>
                </div>
                <div class="request-purpose" style="font-size: 13px; color: #6e6e73; margin-bottom: 8px;">Data augmentation in progress (${columns.length} columns)</div>
                <div class="request-details" style="display: flex; justify-content: space-between; align-items: center;">
                    <div class="data-format" style="font-size: 11px; color: #8e8e93;">Augmented Format</div>
                    <div class="dataset-date" style="font-size: 11px; color: #8e8e93;">${new Date().toISOString().split('T')[0]}</div>
                </div>
            `;
            
            // Add to top of the list
            teamRequestsContainer.insertBefore(newRequestCard, teamRequestsContainer.firstChild);
            
            // Simulate augmentation process
            showNotification('Data augmentation started...');
            
            // After 5 seconds, change to normal dataset
            setTimeout(() => {
                newRequestCard.style.border = '1px solid #e9ecef';
                newRequestCard.style.animation = 'none';
                newRequestCard.querySelector('.team-name').textContent = 'Custom Dataset';
                newRequestCard.querySelector('.request-purpose').textContent = `Custom dataset with ${columns.length} selected columns`;
                newRequestCard.querySelector('.data-format').textContent = 'Custom Format';
                newRequestCard.querySelector('.team-avatar').style.background = '#667eea';
                newRequestCard.querySelector('.team-avatar').innerHTML = '<i class="fas fa-table"></i>';
                showNotification('Dataset augmentation completed!');
            }, 5000);
        }
        
        // Create regular team dataset
        function createTeamDataset() {
            addTeamDataRequest(selectedColumns);
            showNotification(`Team dataset created with ${selectedColumns.length} columns`);
        }
        
        // Add team data request
        function addTeamDataRequest(columns) {
            const teamRequestsContainer = document.querySelector('.team-requests');
            const newRequestId = 'new-request-' + Date.now();
            
            const newRequestCard = document.createElement('div');
            newRequestCard.className = 'team-request-card new-request';
            newRequestCard.style.cssText = 'background: white; border: 2px solid #667eea; border-radius: 8px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease;';
            newRequestCard.onclick = () => selectTeamData(newRequestId);
            
            newRequestCard.innerHTML = `
                <div class="team-info" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <div class="team-avatar" style="width: 24px; height: 24px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;"><i class="fas fa-table"></i></div>
                    <div class="team-name" style="font-weight: 600; color: #1d1d1f;">New Dataset</div>
                </div>
                <div class="request-purpose" style="font-size: 13px; color: #6e6e73; margin-bottom: 8px;">Recently created custom dataset (${columns.length} columns)</div>
                <div class="request-details" style="display: flex; justify-content: space-between; align-items: center;">
                    <div class="data-format" style="font-size: 11px; color: #8e8e93;">Custom Format</div>
                    <div class="dataset-date" style="font-size: 11px; color: #8e8e93;">${new Date().toISOString().split('T')[0]}</div>
                </div>
            `;
            
            // Add to top of the list
            teamRequestsContainer.insertBefore(newRequestCard, teamRequestsContainer.firstChild);
            
            // Change to normal style after 5 seconds
            setTimeout(() => {
                newRequestCard.style.border = '1px solid #e9ecef';
            }, 5000);
        }
        
        // Team data selection
        function selectTeamData(teamId) {
            // Reset master data selection
            const masterSection = document.querySelector('.master-data-section');
            masterSection.style.background = '#f8f9ff';
            masterSection.style.borderColor = '#e0e7ff';
            
            // Remove other team selections
            document.querySelectorAll('.team-request-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Activate clicked card
            event.target.closest('.team-request-card').classList.add('active');
            
            // Show editing interface
            document.getElementById('empty-state').style.display = 'none';
            document.getElementById('column-interface').style.display = 'flex';
            
            // Update interface for team data
            updateColumnInterfaceForTeam(teamId);
            
            currentDataset = teamId;
            showNotification(`${teamId} team data selected for editing`);
        }
        
        // Update column interface for different teams
        function updateColumnInterfaceForTeam(teamId) {
            const teamDataConfigs = {
                'marketing': {
                    title: 'Marketing Team Customized Data',
                    subtitle: 'Dataset for customer analysis and segmentation',
                    totalColumns: 15,
                    columns: [
                        { name: 'customer_id', type: 'Text', group: 'Customer Info' },
                        { name: 'age_group', type: 'Text', group: 'Customer Info' },
                        { name: 'region', type: 'Text', group: 'Customer Info' },
                        { name: 'purchase_date', type: 'DateTime', group: 'Transaction Info' },
                        { name: 'product_category', type: 'Text', group: 'Transaction Info' }
                    ]
                },
                'finance': {
                    title: 'Finance Team Report Data',
                    subtitle: 'Dataset for monthly aggregation and financial analysis',
                    totalColumns: 12,
                    columns: [
                        { name: 'amount', type: 'Number', group: 'Transaction Info' },
                        { name: 'purchase_date', type: 'DateTime', group: 'Transaction Info' },
                        { name: 'payment_method', type: 'Text', group: 'Transaction Info' },
                        { name: 'region', type: 'Text', group: 'Customer Info' }
                    ]
                },
                'sales': {
                    title: 'Sales Team Customer Analysis Data',
                    subtitle: 'Dataset for customer segmentation and lead scoring',
                    totalColumns: 18,
                    columns: [
                        { name: 'customer_name', type: 'Text', group: 'Customer Info' },
                        { name: 'email', type: 'String', group: 'Customer Info' },
                        { name: 'phone', type: 'String', group: 'Customer Info' },
                        { name: 'amount', type: 'Number', group: 'Transaction Info' }
                    ]
                }
            };
            
            const config = teamDataConfigs[teamId];
            if (!config) return;
            
            // Update dataset info
            document.querySelector('.dataset-name').textContent = config.title;
            document.querySelector('.dataset-meta').textContent = `${config.totalColumns} columns • Pre-configured for ${teamId} team`;
            document.getElementById('totalCount').textContent = config.totalColumns;
            
            // Update column list
            const columnContainer = document.querySelector('.column-list-container');
            columnContainer.innerHTML = config.columns.map((col, index) => {
                const metadata = columnMetadata[col.name];
                let metadataHtml = '';
                if (metadata) {
                    if (metadata.alias) {
                        metadataHtml += `<div style="font-size: 10px; color: #667eea; margin-top: 2px;">Alias: ${metadata.alias}</div>`;
                    }
                    if (metadata.description) {
                        metadataHtml += `<div style="font-size: 10px; color: #8e8e93; margin-top: 2px;">${metadata.description}</div>`;
                    }
                }
                
                return `
                <div class="column-item" onclick="clickColumnRow(this)" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; ${index < config.columns.length - 1 ? 'border-bottom: 1px solid #f1f3f4;' : ''} font-size: 13px; cursor: pointer; transition: background 0.2s ease;">
                    <input type="checkbox" class="column-checkbox" data-column="${col.name}" onchange="toggleColumn(this)" onclick="event.stopPropagation()">
                    <div class="column-info" style="flex: 1;">
                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">${col.name}</span>
                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(${col.type})</span>
                        ${metadataHtml}
                    </div>
                    <button class="alias-btn" onclick="showAliasDialog('${col.name}'); event.stopPropagation();" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                    <button class="desc-btn" onclick="showDescDialog('${col.name}'); event.stopPropagation();" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                </div>
                `;
            }).join('');
        }
        
        // Reset to master data view
        function resetToMasterData() {
            document.querySelector('.dataset-name').textContent = 'Master Dataset - Customer Analytics';
            document.querySelector('.dataset-meta').textContent = '247 columns • 1.2M rows • Last updated 2 hours ago';
            document.getElementById('totalCount').textContent = '20';
            
            // Reset to original column list
            const columnContainer = document.querySelector('.column-list-container');
            const masterColumns = ['customer_id', 'customer_name', 'email', 'phone', 'age', 'gender', 'address', 'city', 'country', 'purchase_date', 'amount', 'product_category', 'product_name', 'quantity', 'payment_method', 'discount_rate', 'order_status', 'last_login_date'];
            const masterColumnTypes = ['String', 'String', 'String', 'String', 'Number', 'String', 'Text', 'String', 'String', 'Date', 'Number', 'String', 'String', 'Number', 'String', 'Number', 'String', 'DateTime'];
            
            columnContainer.innerHTML = masterColumns.map((col, index) => {
                const metadata = columnMetadata[col];
                let metadataHtml = '';
                if (metadata) {
                    if (metadata.alias) {
                        metadataHtml += `<div style="font-size: 10px; color: #667eea; margin-top: 2px;">Alias: ${metadata.alias}</div>`;
                    }
                    if (metadata.description) {
                        metadataHtml += `<div style="font-size: 10px; color: #8e8e93; margin-top: 2px;">${metadata.description}</div>`;
                    }
                }
                
                return `
                <div class="column-item" onclick="clickColumnRow(this)" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; ${index < masterColumns.length - 1 ? 'border-bottom: 1px solid #f1f3f4;' : ''} font-size: 13px; cursor: pointer; transition: background 0.2s ease;">
                    <input type="checkbox" class="column-checkbox" data-column="${col}" onchange="toggleColumn(this)" onclick="event.stopPropagation()">
                    <div class="column-info" style="flex: 1;">
                        <span class="column-name" style="font-weight: 500; color: #1d1d1f;">${col}</span>
                        <span class="column-type" style="color: #6e6e73; margin-left: 8px;">(${masterColumnTypes[index]})</span>
                        ${metadataHtml}
                    </div>
                    <button class="alias-btn" onclick="showAliasDialog('${col}'); event.stopPropagation();" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Alias</button>
                    <button class="desc-btn" onclick="showDescDialog('${col}'); event.stopPropagation();" style="background: #f8f9fa; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;">Description</button>
                </div>
                `;
            }).join('');
        }
        
        // Handle column row click
        function clickColumnRow(row) {
            const checkbox = row.querySelector('.column-checkbox');
            checkbox.checked = !checkbox.checked;
            toggleColumn(checkbox);
        }
        
        // Toggle column group
        function toggleGroup(groupId) {
            const columnList = document.getElementById(groupId + '-columns');
            const icon = event.target.querySelector('.group-icon');
            
            if (columnList.style.display === 'none') {
                columnList.style.display = 'grid';
                icon.textContent = '▼';
                icon.classList.remove('collapsed');
            } else {
                columnList.style.display = 'none';
                icon.textContent = '▶';
                icon.classList.add('collapsed');
            }
        }
        
        // Column selection
        function selectColumn(name, type, group) {
            // Remove previous selections
            document.querySelectorAll('.column-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Select current item
            event.target.classList.add('selected');
            event.target.style.background = '#e0e7ff';
            
            // Update column info
            document.getElementById('selected-column-name').textContent = name;
            document.getElementById('column-type-detail').textContent = type;
            document.getElementById('column-group-detail').textContent = group;
            
            // Set sample data
            const sampleData = {
                'customer_id': 'C001, C002, C003, C004, C005...',
                'customer_name': 'John Smith, Jane Doe, Michael Johnson...',
                'email': 'user@email.com, test@gmail.com, info@company.com...',
                'amount': '15000, 89000, 45000, 23000, 67000...',
                'purchase_date': '2024-01-15, 2024-01-16, 2024-01-17...'
            };
            document.getElementById('column-sample').textContent = sampleData[name] || 'Sample values will be displayed here';
            
            // Show column info and actions
            document.getElementById('column-info').style.display = 'flex';
            document.getElementById('column-actions').style.display = 'block';
            
            selectedColumnData = { name, type, group };
        }
        
        // Add column to workspace
        function addToWorkspace() {
            if (!selectedColumnData) return;
            
            // Check if already added
            if (selectedColumns.find(col => col.name === selectedColumnData.name)) {
                showNotification('Column already added to workspace');
                return;
            }
            
            // Add to selected columns
            selectedColumns.push(selectedColumnData);
            
            // Update workspace display
            updateWorkspaceColumns();
            
            showNotification(`${selectedColumnData.name} added to workspace`);
        }
        
        // Update workspace column display
        function updateWorkspaceColumns() {
            const container = document.getElementById('selected-columns');
            
            if (selectedColumns.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: #6e6e73; font-size: 13px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 2px dashed #d1d5db;">
                        <i class="fas fa-plus-circle" style="font-size: 24px; margin-bottom: 8px; color: #9ca3af;"></i>
                        <div>No columns selected</div>
                        <div style="font-size: 11px; margin-top: 4px;">Select columns from editing studio to see them here</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = selectedColumns.map((col, index) => {
                const metadata = columnMetadata[col.name];
                let metadataLines = '';
                if (metadata) {
                    if (metadata.alias) {
                        metadataLines += `<div style="font-size: 10px; color: #667eea; margin-top: 2px;">Alias: ${metadata.alias}</div>`;
                    }
                    if (metadata.description) {
                        metadataLines += `<div style="font-size: 10px; color: #8e8e93; margin-top: 2px;">${metadata.description}</div>`;
                    }
                }
                
                return `
                <div class="selected-column-item" style="background: white; border: 1px solid #e9ecef; border-radius: 6px; padding: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: 500; color: #1d1d1f; font-size: 13px;">${col.name}</div>
                        <div style="font-size: 11px; color: #6e6e73;">${col.type} • ${col.group}</div>
                        ${metadataLines}
                    </div>
                    <button onclick="removeFromWorkspace(${index})" style="background: #ef4444; color: white; border: none; border-radius: 4px; width: 20px; height: 20px; font-size: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-times" style="font-size: 8px;"></i>
                    </button>
                </div>
                `;
            }).join('');
        }
        
        // Remove column from workspace
        function removeFromWorkspace(index) {
            const removedColumn = selectedColumns[index];
            selectedColumns.splice(index, 1);
            updateWorkspaceColumns();
            updateDuplicationCheck();
            updateSelectedCount();
            showNotification(`${removedColumn.name} removed from workspace`);
        }
        
        // Send workspace message
        function sendWorkspaceMessage() {
            const input = document.querySelector('.team-chat input');
            const message = input.value.trim();
            
            if (!message) return;
            
            const messagesContainer = document.querySelector('.chat-messages');
            const newMessage = document.createElement('div');
            newMessage.className = 'message';
            newMessage.style.cssText = 'margin-bottom: 12px; padding: 8px; background: #f8f9fa; border-radius: 6px; font-size: 12px;';
            newMessage.innerHTML = `
                <div style="color: #667eea; font-weight: 600;">You: </div>
                <div style="color: #6e6e73;">${message}</div>
            `;
            
            messagesContainer.appendChild(newMessage);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            input.value = '';
            showNotification('Message sent to team');
        }
        
        // Show notification
        function showNotification(message) {
            // Create notification element if it doesn't exist
            let notification = document.getElementById('workspace-notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'workspace-notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #667eea;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 6px;
                    font-size: 14px;
                    z-index: 10000;
                    opacity: 0;
                    transform: translateY(-20px);
                    transition: all 0.3s ease;
                `;
                document.body.appendChild(notification);
            }
            
            notification.textContent = message;
            notification.style.opacity = '1';
            notification.style.transform = 'translateY(0)';
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
            }, 3000);
        }

        // Initialize workspace
        function initializeWorkspace() {
            updateWorkspaceColumns();
            updateDuplicationCheck();
            updateSelectedCount();
        }

        // Show related reports
        function showRelatedReports(reports) {
            const reportsSection = document.getElementById('related-reports-section');
            const container = document.getElementById('related-reports-container');

            container.innerHTML = '';

            reports.forEach(report => {
                const reportElement = document.createElement('div');
                reportElement.className = 'related-report-item';
                reportElement.onclick = () => navigateToReport(report.reportId);

                reportElement.innerHTML = `
                    <div class="report-agent-info">${report.agent} • 연관도 ${report.relevanceScore}%</div>
                    <div class="report-title">${report.title}</div>
                `;

                container.appendChild(reportElement);
            });

            reportsSection.style.display = 'block';
        }

        // Navigate to report
        function navigateToReport(reportId) {
            alert(`Moving to ${reportId} report.\n\nYou can check analysis results to prevent duplicate work and utilize existing insights.`);
            
            // Example: scroll to report section or show modal
            // window.location.hash = `#report-${reportId}`;
        }

        // Hide duplication indicator
        function hideDuplicationIndicator() {
            const indicator = document.getElementById('duplicate-indicator');
            const reportsSection = document.getElementById('related-reports-section');
            
            indicator.style.display = 'none';
            reportsSection.style.display = 'none';
        }

        // Enhanced duplication check with related reports
        function checkForRelatedReports(columns) {
            const mockRelatedReports = [
                {
                    reportId: 'MKT_001',
                    agent: 'Marketing Agent',
                    title: 'Customer Segmentation Analysis',
                    relevanceScore: 92,
                    commonColumns: ['customer_id', 'purchase_date', 'amount']
                },
                {
                    reportId: 'FIN_002', 
                    agent: 'Finance Agent',
                    title: 'Revenue Analysis Report',
                    relevanceScore: 78,
                    commonColumns: ['amount', 'purchase_date']
                },
                {
                    reportId: 'SAL_001',
                    agent: 'Sales Agent', 
                    title: 'Lead Scoring Model',
                    relevanceScore: 65,
                    commonColumns: ['customer_id', 'email']
                }
            ];

            const selectedColumnNames = columns.map(col => col.name);
            const relatedReports = [];

            mockRelatedReports.forEach(report => {
                const commonCount = report.commonColumns.filter(col => 
                    selectedColumnNames.includes(col)
                ).length;
                
                if (commonCount >= 2) {
                    relatedReports.push({
                        ...report,
                        relevanceScore: Math.min(95, report.relevanceScore + commonCount * 5)
                    });
                }
            });

            if (relatedReports.length > 0) {
                showRelatedReports(relatedReports);
            }
        }

        // Discussion tab switching
        function switchDiscussionTab(tabName) {
            // Remove active class from all tabs
            document.querySelectorAll('.report-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.color = '#6e6e73';
                tab.style.transform = 'translateY(0)';
                tab.style.boxShadow = 'none';
            });
            
            // Remove active class from all tab contents
            document.querySelectorAll('.report-tab-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // Activate selected tab
            event.target.classList.add('active');
            event.target.style.color = '#667eea';
            event.target.style.transform = 'translateY(-2px)';
            event.target.style.boxShadow = '0 4px 8px rgba(102, 126, 234, 0.1)';
            
            // Show selected content
            document.getElementById(tabName + '-content').classList.add('active');
            document.getElementById(tabName + '-content').style.display = 'block';
        }

        // Send discussion message
        function sendDiscussionMessage() {
            const input = document.getElementById('reportMessageInput');
            const message = input.value.trim();
            
            if (message === '') return;
            
            // Current time
            const now = new Date();
            const time = now.getHours().toString().padStart(2, '0') + ':' + 
                        now.getMinutes().toString().padStart(2, '0');
            
            // Add message
            const chatMessages = document.getElementById('reportChatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.style.marginBottom = '16px';
            messageDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <div style="width: 24px; height: 24px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">Me</div>
                    <span style="font-size: 12px; font-weight: 600; color: #1d1d1f;">Me</span>
                    <span style="font-size: 11px; color: #8e8e93;">${time}</span>
                </div>
                <div style="font-size: 13px; color: #374151; line-height: 1.4; padding-left: 32px;">${message}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Reset input field
            input.value = '';
        }

        // Send message with Enter key
        document.addEventListener('DOMContentLoaded', function() {
            const reportInput = document.getElementById('reportMessageInput');
            if (reportInput) {
                reportInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendReportMessage();
                    }
                });
            }
            
            // Auto-scroll chat
            const chatMessages = document.getElementById('reportChatMessages');
            if (chatMessages) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        });

        // Agent Analysis Functions
        let selectedModules = [];
        let currentTeam = null;
        let isAnalysisComplete = false;
        let collaborationCart = [];
        let selectedTemplate = null;
        
        // Team data information
        const teamData = {
            marketing: {
                title: "Marketing Team Agent Analysis",
                request: "Customer segment churn rate analysis and retention strategy development",
                insights: [
                    { icon: "fas fa-chart-bar", text: "Customer purchase data 12,847 records confirmed" },
                    { icon: "fas fa-calendar-alt", text: "2023-2024 24-month period data" },
                    { icon: "fas fa-bullseye", text: "Structure optimized for RFM analysis confirmed" },
                    { icon: "fas fa-exclamation-triangle", text: "Recent 3-month churn customer data insufficient" }
                ],
                modules: [
                    { id: 'rfm', icon: 'fas fa-users', title: 'RFM Customer Segment', desc: 'Customer classification and churn prediction based on purchase frequency/amount/recency', confidence: 95, time: 3 },
                    { id: 'churn', icon: 'fas fa-user-times', title: 'Churn Risk Customer Detection', desc: 'Identify customers with high churn probability through purchase pattern changes', confidence: 88, time: 4 },
                    { id: 'retention', icon: 'fas fa-user-check', title: 'Retention Strategy Development', desc: 'Segment-specific retention strategies and action plans', confidence: 92, time: 5 }
                ]
            },
            finance: {
                title: "Finance Team Agent Analysis",
                request: "Marketing campaign ROI optimization and budget allocation strategy",
                insights: [
                    { icon: "fas fa-dollar-sign", text: "Campaign cost data 847 records confirmed" },
                    { icon: "fas fa-chart-line", text: "15 channels with ROI tracking capability" },
                    { icon: "fas fa-bullseye", text: "Performance measurement KPI system complete" },
                    { icon: "fas fa-question-circle", text: "Organic traffic contribution data needed" }
                ],
                modules: [
                    { id: 'roi', icon: 'fas fa-percentage', title: 'ROI Analysis & Optimization', desc: 'Channel-wise ROI analysis and budget reallocation', confidence: 93, time: 4 },
                    { id: 'budget', icon: 'fas fa-chart-pie', title: 'Budget Allocation Strategy', desc: 'Performance-based optimal budget allocation simulation', confidence: 87, time: 6 },
                    { id: 'attribution', icon: 'fas fa-link', title: 'Attribution Modeling', desc: 'Multi-channel contribution analysis and touchpoint optimization', confidence: 82, time: 7 }
                ]
            },
            sales: {
                title: "Sales Team Agent Analysis",
                request: "Customer LTV prediction and sales priority optimization",
                insights: [
                    { icon: "fas fa-users", text: "Lead and customer data 5,234 records confirmed" },
                    { icon: "fas fa-briefcase", text: "Sales stage conversion rate tracking available" },
                    { icon: "fas fa-phone", text: "Contact history and performance data complete" },
                    { icon: "fas fa-exclamation", text: "Customer satisfaction survey data supplementation needed" }
                ],
                modules: [
                    { id: 'ltv', icon: 'fas fa-gem', title: 'LTV Prediction Model', desc: 'Customer lifetime value prediction and priority matrix', confidence: 91, time: 5 },
                    { id: 'pipeline', icon: 'fas fa-funnel-dollar', title: 'Sales Pipeline Optimization', desc: 'Stage-wise conversion improvement points and action plans', confidence: 89, time: 4 },
                    { id: 'scoring', icon: 'fas fa-star', title: 'Lead Scoring', desc: 'Automatic lead priority scoring based on closing probability', confidence: 86, time: 3 }
                ]
            }
        };

        // Team selection function
        function selectTeam(team) {
            currentTeam = team;
            
            // Update team dataset UI
            document.querySelectorAll('.team-dataset').forEach(d => d.classList.remove('active'));
            event.target.closest('.team-dataset').classList.add('active');
            
            // Update header information
            const teamInfo = teamData[team];
            document.getElementById('selectedTeamTitle').textContent = teamInfo.title;
            document.getElementById('analysisRequest').textContent = `Step 4 Request: "${teamInfo.request}"`;
            
            // Reset existing analysis state
            selectedModules = [];
            isAnalysisComplete = false;
            
            // Reset collaboration cart
            collaborationCart = [];
            updateCartUI();
            
            // Hide all comment sections
            document.querySelectorAll('.collab-comment-section').forEach(section => {
                section.classList.remove('show');
            });
            
            // Hide Sense speech bubble
            if (document.getElementById('senseTooltip')) {
                document.getElementById('senseTooltip').style.opacity = '0';
                document.getElementById('senseTooltip').style.visibility = 'hidden';
            }
            
            // Hide empty state
            document.getElementById('emptyState').style.display = 'none';
            
            // Restart auto review
            resetToAutoReview();
        }
        
        // Reset with auto review
        function resetToAutoReview() {
            if (!currentTeam) return;
            
            document.getElementById('recommendedModules').style.display = 'none';
            document.getElementById('executeSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('autoReviewSection').style.display = 'block';
            
            // Initialize progress bar
            const progressFill = document.getElementById('reviewProgressFill');
            const progressText = document.getElementById('reviewProgressText');
            progressFill.style.width = '0%';
            progressText.textContent = 'Analyzing data received from Step 4...';
            
            // Update insights
            const insightsContainer = document.getElementById('reviewInsights');
            const teamInfo = teamData[currentTeam];
            
            insightsContainer.innerHTML = '';
            teamInfo.insights.forEach((insight, index) => {
                const item = document.createElement('div');
                item.className = 'insight-item';
                item.style.cssText = 'background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 12px 16px; display: flex; align-items: center; gap: 12px; font-size: 14px; transition: all 0.3s ease; opacity: 0; transform: translateY(10px);';
                item.innerHTML = `
                    <i class="${insight.icon}" style="color: #667eea; width: 16px;"></i>
                    <span>${insight.text}</span>
                `;
                insightsContainer.appendChild(item);
            });
            
            // Restart after progress reset
            setTimeout(() => {
                startAutoReview();
            }, 500);
        }
        
        // Start auto data review
        function startAutoReview() {
            if (!currentTeam) return;
            
            const progressFill = document.getElementById('reviewProgressFill');
            const progressText = document.getElementById('reviewProgressText');
            const insights = document.querySelectorAll('.insight-item');
            
            // Progress animation
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    
                    // Show modules after review complete
                    setTimeout(() => {
                        showRecommendedModules();
                    }, 1000);
                }
                progressFill.style.width = progress + '%';
                
                // Change text for each progress step
                if (progress < 30) {
                    progressText.textContent = 'Analyzing data received from Step 4...';
                } else if (progress < 60) {
                    progressText.textContent = 'Validating data structure and quality...';
                } else if (progress < 90) {
                    progressText.textContent = 'Detecting available analysis modules...';
                } else {
                    progressText.textContent = '✅ Data review complete! Preparing recommended modules...';
                }
            }, 200);

            // Display insights sequentially
            insights.forEach((insight, index) => {
                setTimeout(() => {
                    insight.style.opacity = '1';
                    insight.style.transform = 'translateY(0)';
                }, (index + 1) * 800);
            });
        }
        
        // Display recommended modules
        function showRecommendedModules() {
            if (!currentTeam) return;
            
            document.getElementById('autoReviewSection').style.display = 'none';
            document.getElementById('recommendedModules').style.display = 'block';
            
            // Dynamic module card generation
            const modulesGrid = document.getElementById('modulesGrid');
            const teamInfo = teamData[currentTeam];
            
            modulesGrid.innerHTML = '';
            teamInfo.modules.forEach((module, index) => {
                const moduleCard = document.createElement('div');
                moduleCard.className = 'module-card';
                moduleCard.setAttribute('data-module', module.id);
                moduleCard.onclick = () => selectModule(module.id);
                moduleCard.style.cssText = 'position: relative; opacity: 0; transform: translateY(20px);';
                moduleCard.innerHTML = `
                    <div style="font-size: 24px; margin-bottom: 12px; color: #667eea;"><i class="${module.icon}"></i></div>
                    <div style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 8px;">${module.title}</div>
                    <div style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">${module.desc}</div>
                    <div style="font-size: 12px; color: #9ca3af; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #dcfce7; color: #166534; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">Suitability ${module.confidence}%</span>
                        <span>Est. time: ${module.time}min</span>
                    </div>
                `;
                modulesGrid.appendChild(moduleCard);
                
                // Sequential display
                setTimeout(() => {
                    moduleCard.style.opacity = '1';
                    moduleCard.style.transform = 'translateY(0)';
                }, index * 300);
            });
        }
        
        // Module selection
        function selectModule(moduleId) {
            // Deselect all modules
            document.querySelectorAll('.module-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Display selected module
            const selectedCard = document.querySelector(`[data-module="${moduleId}"]`);
            selectedCard.classList.add('selected');
            selectedModules = [moduleId];
            
            // Display execute button
            document.getElementById('executeSection').style.display = 'block';
            
            // Update button text
            const teamInfo = teamData[currentTeam];
            const module = teamInfo.modules.find(m => m.id === moduleId);
            document.getElementById('executeButton').textContent = `Start ${module.title} Analysis`;
        }
        
        // Custom analysis request
        function submitCustomRequest() {
            const input = document.getElementById('customAnalysisInput');
            const customText = input.value.trim();
            
            if (customText) {
                // Add custom module card
                const modulesGrid = document.getElementById('modulesGrid');
                const customCard = document.createElement('div');
                customCard.className = 'module-card selected';
                customCard.setAttribute('data-module', 'custom');
                customCard.onclick = () => selectModule('custom');
                customCard.style.cssText = 'background: #f0f4ff; border: 2px solid #667eea; border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative; opacity: 1; transform: translateY(0);';
                customCard.innerHTML = `
                    <div style="font-size: 24px; margin-bottom: 12px; color: #667eea;"><i class="fas fa-cog"></i></div>
                    <div style="font-size: 16px; font-weight: 600; color: #171719; margin-bottom: 8px;">Custom Analysis</div>
                    <div style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">${customText}</div>
                    <div style="font-size: 12px; color: #9ca3af; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">Reviewing</span>
                        <span>Est. time: Calculating</span>
                    </div>
                `;
                modulesGrid.appendChild(customCard);
                
                // Set to selected state
                selectedModules = ['custom'];
                document.getElementById('executeSection').style.display = 'block';
                document.getElementById('executeButton').textContent = 'Start Custom Analysis';
                
                input.value = '';
            }
        }

        // Start analysis function
        function startAnalysis() {
            // UI 전환 - 추천 모듈 섹션과 분석 선택 섹션 숨기기
            document.getElementById('recommendedModules').style.display = 'none';
            document.getElementById('executeSection').style.display = 'none';
            document.getElementById('analysisProgress').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';
            
            // SPAR 프로세스 시뮬레이션
            simulateSparProcess();
        }

        // SPAR 프로세스 시뮬레이션
        function simulateSparProcess() {
            const sparSteps = document.querySelectorAll('.spar-step');
            const progressFill = document.getElementById('progressFill');
            const progressContent = document.getElementById('progressContent');
            
            const steps = [
                { name: 'Plan', desc: 'Establishing RFM analysis strategy...', progress: 35, index: 1 },
                { name: 'Act', desc: 'Running segment classification and prediction model...', progress: 70, index: 2 },
                { name: 'Reflect', desc: 'Validating results and deriving insights...', progress: 100, index: 3 }
            ];

            let currentStep = 0;

            function updateStep() {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    
                    // Handle previous step completion
                    if (currentStep > 0) {
                        sparSteps[steps[currentStep-1].index].style.background = '#e7f5e7';
                        const prevDescDiv = sparSteps[steps[currentStep-1].index].querySelector('div:nth-child(2) div:nth-child(2)');
                        if (prevDescDiv) prevDescDiv.textContent = 'Complete';
                    }
                    
                    // 현재 단계를 진행 중 상태로 활성화
                    sparSteps[step.index].style.background = '#ff9500';
                    sparSteps[step.index].style.color = 'white';
                    const currentDescDiv = sparSteps[step.index].querySelector('div:nth-child(2) div:nth-child(2)');
                    if (currentDescDiv) {
                        currentDescDiv.textContent = step.desc.replace(step.name + ' Step: ', '');
                        currentDescDiv.style.color = 'rgba(255, 255, 255, 0.9)';
                    }
                    
                    // 진행률 업데이트
                    progressFill.style.width = step.progress + '%';
                    progressContent.textContent = `${step.name} Step: ${step.desc}`;
                    
                    currentStep++;
                    setTimeout(updateStep, 2500);
                } else {
                    // Analysis complete
                    completeAnalysis();
                }
            }

            // Plan 단계부터 시작
            sparSteps[1].style.background = '#ff9500';
            sparSteps[1].style.color = 'white';
            const planDescDiv = sparSteps[1].querySelector('div:nth-child(2) div:nth-child(2)');
            if (planDescDiv) {
                planDescDiv.textContent = 'Establishing RFM analysis strategy...';
                planDescDiv.style.color = 'rgba(255, 255, 255, 0.9)';
            }
            updateStep();
        }

        // Analysis complete
        function completeAnalysis() {
            // UI 전환
            document.getElementById('analysisProgress').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            // All SPAR steps complete
            document.querySelectorAll('.spar-step').forEach(step => {
                step.style.background = '#e7f5e7';
                step.style.color = '';
                const descDiv = step.querySelector('div:nth-child(2) div:nth-child(2)');
                if (descDiv) {
                    descDiv.textContent = 'Complete';
                    descDiv.style.color = '';
                }
            });
            
            // 세그먼트 분석 결과 표시
            showSegmentResults();
            
            // 협업 요약 업데이트
            updateCollaborationSummary();
            
            isAnalysisComplete = true;
        }
        
        // 세그먼트 분석 결과 표시
        function showSegmentResults() {
            // 마케팅 팀일 때만 탭 네비게이션 표시
            if (currentTeam === 'marketing') {
                document.getElementById('resultsTabs').style.display = 'block';
                showTab('segment');
            } else {
                // 다른 팀은 탭 없이 바로 원래 분석 결과 표시
                document.getElementById('resultsTabs').style.display = 'none';
            }
        }
        
        // 탭 전환 기능
        function showTab(tabName) {
            // 모든 탭 버튼 비활성화
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = 'transparent';
                btn.style.color = '#666';
                btn.style.fontWeight = '500';
                btn.style.boxShadow = 'none';
            });
            
            // 모든 탭 콘텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // 선택된 탭 활성화
            if (event && event.target) {
                event.target.classList.add('active');
                event.target.style.background = 'white';
                event.target.style.color = '#667eea';
                event.target.style.fontWeight = '600';
                event.target.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
            } else {
                // 기본적으로 첫 번째 탭 활성화
                const firstTab = document.querySelector('.tab-btn');
                firstTab.classList.add('active');
                firstTab.style.background = 'white';
                firstTab.style.color = '#667eea';
                firstTab.style.fontWeight = '600';
                firstTab.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
            }
            
            const targetTab = document.getElementById(tabName + 'Tab');
            if (targetTab) {
                targetTab.classList.add('active');
                targetTab.style.display = 'block';
            }
        }


        // 팀 드롭다운 표시
        function showTeamDropdown(button) {
            // 다른 드롭다운 모두 닫기
            document.querySelectorAll('.team-dropdown').forEach(dropdown => {
                if (dropdown !== button.querySelector('.team-dropdown')) {
                    dropdown.style.opacity = '0';
                    dropdown.style.visibility = 'hidden';
                    dropdown.style.transform = 'translateY(-10px)';
                }
            });
            
            // 현재 드롭다운 토글
            const dropdown = button.querySelector('.team-dropdown');
            if (dropdown.style.opacity === '1') {
                dropdown.style.opacity = '0';
                dropdown.style.visibility = 'hidden';
                dropdown.style.transform = 'translateY(-10px)';
            } else {
                dropdown.style.opacity = '1';
                dropdown.style.visibility = 'visible';
                dropdown.style.transform = 'translateY(0)';
            }
            
            // 외부 클릭 시 닫기
            setTimeout(() => {
                document.addEventListener('click', function closeDropdown(e) {
                    if (!button.contains(e.target)) {
                        dropdown.style.opacity = '0';
                        dropdown.style.visibility = 'hidden';
                        dropdown.style.transform = 'translateY(-10px)';
                        document.removeEventListener('click', closeDropdown);
                    }
                });
            }, 100);
        }

        // 협업 추가 함수
        function addCollaboration(element, team, purpose) {
            // 결과 항목 식별 - 가장 가까운 분석 결과 div 찾기
            const resultItem = element.closest('div[style*="background: white"][style*="border: 1px solid"]');
            const resultContent = resultItem ? resultItem.querySelector('strong')?.textContent || 'Analysis Result' : 'Analysis Result';
            
            // 중복 체크
            const existingItem = collaborationCart.find(item => 
                item.team === team && item.resultType === resultContent
            );
            
            if (!existingItem) {
                // 장바구니에 추가
                collaborationCart.push({
                    team: team,
                    purpose: purpose,
                    resultType: resultContent,
                    resultItem: resultItem
                });
                
                // 시각적 피드백
                const addBtn = resultItem.querySelector('.add-team-btn');
                const originalText = addBtn.innerHTML;
                addBtn.innerHTML = `✓ ${team} added`;
                addBtn.style.background = '#28a745';
                addBtn.style.color = 'white';
                addBtn.style.borderColor = '#28a745';
                
                // 코멘트 섹션 표시
                const commentSection = resultItem.querySelector('.collab-comment-section');
                if (commentSection) {
                    commentSection.style.display = 'block';
                }
                
                setTimeout(() => {
                    addBtn.innerHTML = originalText;
                    addBtn.style.background = '';
                    addBtn.style.color = '';
                    addBtn.style.borderColor = '';
                }, 1500);
                
                // 장바구니 UI 업데이트
                updateCartUI();
            }
            
            // 드롭다운 닫기
            element.closest('.team-dropdown').style.opacity = '0';
            element.closest('.team-dropdown').style.visibility = 'hidden';
            element.closest('.team-dropdown').style.transform = 'translateY(-10px)';
        }

        // 장바구니 UI 업데이트
        function updateCartUI() {
            const cartItems = document.getElementById('cartItems');
            const sendBtn = document.getElementById('sendCollabBtn');
            
            if (collaborationCart.length === 0) {
                cartItems.innerHTML = '<div style="text-align: center; color: #8e8e93; font-size: 14px; padding: 20px;">No collaboration requests selected yet</div>';
                sendBtn.disabled = true;
                sendBtn.style.background = '#dee2e6';
                sendBtn.style.color = '#adb5bd';
                sendBtn.style.cursor = 'not-allowed';
            } else {
                cartItems.innerHTML = collaborationCart.map((item, index) => `
                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 6px; padding: 12px; margin-bottom: 8px; font-size: 13px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <strong>${item.team}</strong>: ${item.purpose}
                        </div>
                        <div onclick="removeFromCart(${index})" style="background: #ff6b6b; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 12px; transition: all 0.3s ease; margin-left: 8px;">×</div>
                    </div>
                `).join('');
                sendBtn.disabled = false;
                sendBtn.style.background = '#28a745';
                sendBtn.style.color = 'white';
                sendBtn.style.cursor = 'pointer';
            }
            
            updateCollaborationSummary();
        }

        // 장바구니에서 제거
        function removeFromCart(index) {
            collaborationCart.splice(index, 1);
            updateCartUI();
        }

        // 협업 요청 전송
        function sendCollaborationRequests() {
            if (collaborationCart.length === 0) return;
            
            // 성공 메시지 표시
            const successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            
            // 버튼 상태 변경
            const sendBtn = document.getElementById('sendCollabBtn');
            sendBtn.textContent = 'Complete ✓';
            sendBtn.style.background = '#28a745';
            sendBtn.disabled = true;
            
            // 장바구니 비우기
            collaborationCart = [];
            
            setTimeout(() => {
                successMsg.style.display = 'none';
                sendBtn.textContent = 'Send Collaboration Request';
                sendBtn.style.background = '';
                updateCartUI();
            }, 3000);
        }
        
        
        // 협업 요약 업데이트
        function updateCollaborationSummary() {
            const collaborateCount = collaborationCart.length;
            document.getElementById('collaborateCount').textContent = collaborateCount;
        }

        // Page load
        window.addEventListener('load', function() {
            initialize();
            initializeWorkspace();
            
            // Agent analysis initialization
            setTimeout(() => {
                if (document.getElementById('teamContext')) {
                    const teamContext = document.getElementById('teamContext');
                    const sparSection = document.getElementById('sparSection');
                    
                    // Remove pulse effect after 10 seconds
                    setTimeout(() => {
                        if (teamContext) teamContext.style.animation = '';
                        if (sparSection) sparSection.style.animation = '';
                    }, 10000);
                }
            }, 1000);
        });
    </script>

    <script>
        // .content-view가 다른 .content-view 안에 들어가면 main-content로 자동 이동
        (function guardContentViewNesting() {
        const main = document.querySelector('.main-content');
        if (!main) return;
            document.querySelectorAll('.content-view').forEach((v) => {
            const wrongAncestor = v.parentElement?.closest('.content-view');
                if (wrongAncestor) {
            console.warn('[ContentViewNested]', v.id, 'inside', wrongAncestor.id, '→ moving to .main-content');
            main.appendChild(v);
            }
            });
        })();
    </script>

</body>
</html>